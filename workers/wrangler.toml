# =============================================================================
# Blaze Sports Intel â€” Workers Configuration (Hybrid Router)
# =============================================================================
# This Worker is the apex entry-point for blazesportsintel.com.
# It handles dynamic routes (API, WebSocket, auth) and proxies static
# requests to the Cloudflare Pages project.
# =============================================================================

name = "blazesportsintel-worker"
main = "index.ts"
compatibility_date = "2024-08-23"

# Production environment
[env.production]
name = "blazesportsintel-worker-prod"
routes = [
  { pattern = "blazesportsintel.com/*", zone_name = "blazesportsintel.com" },
  { pattern = "www.blazesportsintel.com/*", zone_name = "blazesportsintel.com" }
]

# ---------------------------------------------------------------------------
# KV Namespaces
# ---------------------------------------------------------------------------
[[kv_namespaces]]
binding = "KV"
id = "b666864ae6fe4576a7cb94277d6ef4f2"
preview_id = "314e25f60fbd436e8ba3af4d34b8351c"

# ---------------------------------------------------------------------------
# Durable Objects
# ---------------------------------------------------------------------------
[[durable_objects.bindings]]
name = "CACHE"
class_name = "CacheObject"

[[migrations]]
tag = "v1"
new_classes = ["CacheObject"]

# ---------------------------------------------------------------------------
# Environment Variables
# ---------------------------------------------------------------------------
[vars]
ENVIRONMENT = "production"
API_VERSION = "1.0.0"
PAGES_ORIGIN = "https://blazesportsintel.pages.dev"

# ---------------------------------------------------------------------------
# Secrets (set via `wrangler secret put`)
# ---------------------------------------------------------------------------
# NOTION_TOKEN
# STRIPE_SECRET_KEY
# AMPLITUDE_API_KEY

# ---------------------------------------------------------------------------
# Development
# ---------------------------------------------------------------------------
[dev]
port = 8787
local_protocol = "http"
