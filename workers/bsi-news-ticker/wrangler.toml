name = "bsi-news-ticker"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

account_id = "a12cb329d84130460eed99b816e4d0d3"

# Durable Objects
[durable_objects]
bindings = [
  { name = "NEWS_TICKER", class_name = "NewsTickerDO" }
]

[[migrations]]
tag = "v1"
new_classes = ["NewsTickerDO"]

# Queues
[[queues.producers]]
queue = "news-ingest"
binding = "NEWS_QUEUE"

[[queues.consumers]]
queue = "news-ingest"
max_batch_size = 10
max_batch_timeout = 5

# Environment Variables
[vars]
ESPN_API_BASE = "https://site.api.espn.com/apis/site/v2/sports"
MLB_API_BASE = "https://statsapi.mlb.com/api/v1"
NFL_API_BASE = "https://site.api.espn.com/apis/site/v2/sports/football/nfl"

# KV Namespace for caching
[[kv_namespaces]]
binding = "TICKER_CACHE"
id = "5d01a9493aaa4b29866bf7a1f411a984"

# Cron triggers for news refresh
[triggers]
crons = ["*/5 * * * *"]

# Custom domain route
routes = [
  { pattern = "ticker.blazesportsintel.com/*", zone_name = "blazesportsintel.com" }
]
