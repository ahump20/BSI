---
description: GitHub Actions and CI/CD
globs:
  - .github/workflows/**/*.yml
  - .github/workflows/**/*.yaml
---

# GitHub Workflows (BSI)

## Active workflows
| Workflow | Trigger | Purpose |
|----------|---------|---------|
| `api-tests.yml` | PR/push | Type check, lint, test |
| `accessibility-tests.yml` | HTML/TS changes | WCAG compliance |
| `workers-compat-lint.yml` | Worker changes | CF compatibility |
| `deploy-pages.yml` | Push to main | Deploy to CF Pages |
| `lighthouse-ci.yml` | Scheduled | Performance monitoring |
| `data-freshness.yml` | Scheduled | Data quality alerts |

## Workflow conventions

### Job naming
```yaml
jobs:
  type-check:
    name: Type Check
  lint:
    name: Lint
  test:
    name: Unit Tests
```

### Environment variables
- Use GitHub secrets for sensitive values
- Never hardcode API keys
- Use `${{ secrets.NAME }}` syntax

### Caching
```yaml
- uses: actions/cache@v4
  with:
    path: ~/.npm
    key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
```

### Notifications
- Slack alerts for failures (via data-freshness.yml pattern)
- Email for critical failures

## Testing workflows locally
```bash
# Use act for local workflow testing
act -j test
```

## Adding new workflows
1. Follow naming: `{purpose}.yml`
2. Include `name:` for clarity
3. Set appropriate triggers
4. Add to workflow docs if significant
