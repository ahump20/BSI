---
description: Scripts and automation conventions
globs:
  - scripts/**/*.js
  - scripts/**/*.sh
  - scripts/**/*.py
---

# Scripts (BSI)

The `scripts/` folder contains automation for data ingestion, deployment, and maintenance.

## Script categories

### Data ingestion (`ingest-*.js`)
- Fetch from external APIs
- Validate data before storing
- Log success/failure with counts
- Handle rate limits gracefully

### Deployment (`deploy-*.sh`)
- Run pre-flight checks before deploying
- Include rollback instructions
- Log all operations

### Database (`setup-*.js`, `migrate-*.js`)
- Idempotent where possible
- Include dry-run option
- Backup before destructive operations

### Validation (`validate-*.sh`, `check-*.js`)
- Return non-zero exit codes on failure
- Output actionable error messages
- Integrate with CI where appropriate

## Conventions

### Shell scripts
```bash
#!/bin/bash
set -euo pipefail  # Exit on error, undefined vars, pipe failures
```

### Node scripts
```javascript
// Include shebang for CLI use
#!/usr/bin/env node

// Handle errors explicitly
process.on('unhandledRejection', (err) => {
  console.error('Fatal:', err);
  process.exit(1);
});
```

### Python scripts
```python
#!/usr/bin/env python3
# Use type hints
# Include if __name__ == '__main__' guard
```

## Common scripts reference
| Script | Purpose |
|--------|---------|
| `ingest-live-data.js` | Live sports data fetch |
| `ingest-college-baseball.js` | NCAA baseball data |
| `setup-database.js` | D1 schema setup |
| `deploy-after-bindings.sh` | Deploy with CF bindings |
| `health_check.py` | System health monitoring |
| `production-readiness-check.sh` | Pre-deploy validation |
