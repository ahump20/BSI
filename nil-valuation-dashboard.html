<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NIL Valuation Intelligence Platform | Blaze Sports Intel</title>
    
    <!-- React 18 with Concurrent Features -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Advanced Charting Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/recharts@2.5.0/dist/Recharts.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script>
    
    <!-- Data Management -->
    <script src="https://cdn.jsdelivr.net/npm/axios@1.6.0/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
    
    <!-- Real-time & State Management -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://unpkg.com/zustand@4.4.1/vanilla.mjs" type="module"></script>
    
    <!-- Icons & UI -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lucide-static@0.263.0/font/lucide.css">
    
    <style>
        :root {
            --primary: #ff6b35;
            --primary-dark: #e55a2b;
            --success: #4ade80;
            --warning: #fbbf24;
            --danger: #ef4444;
            --bg-primary: #0a0a0f;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #252542;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b8;
            --border: rgba(255, 107, 53, 0.2);
            --shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* Advanced Animations */
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { background-position: -200% center; }
            100% { background-position: 200% center; }
        }

        .app {
            min-height: 100vh;
            background: radial-gradient(ellipse at top, #1a1a2e, #0a0a0f);
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95), rgba(37, 37, 66, 0.95));
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
            animation: slideIn 0.5s ease;
        }

        .header-content {
            max-width: 1440px;
            margin: 0 auto;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .live-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: rgba(74, 222, 128, 0.1);
            border: 1px solid var(--success);
            border-radius: 20px;
            font-size: 0.875rem;
            color: var(--success);
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        /* Dashboard Container */
        .dashboard {
            max-width: 1440px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Metrics Grid */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
            animation: slideIn 0.6s ease;
        }

        .metric-card {
            background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 53, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
            border-color: var(--primary);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .metric-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 107, 53, 0.1);
            border-radius: 8px;
            color: var(--primary);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--text-primary), var(--primary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .metric-change {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .metric-change.positive { color: var(--success); }
        .metric-change.negative { color: var(--danger); }

        .metric-sparkline {
            margin-top: 1rem;
            height: 40px;
            opacity: 0.7;
        }

        /* Search & Filters */
        .control-panel {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--border);
        }

        .search-container {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .search-wrapper {
            flex: 1;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            background: var(--bg-primary);
            border: 2px solid transparent;
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
        }

        .filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-chip {
            padding: 0.625rem 1.25rem;
            background: var(--bg-primary);
            border: 2px solid transparent;
            border-radius: 10px;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .filter-chip:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-chip.active {
            background: var(--primary);
            color: var(--bg-primary);
            border-color: var(--primary);
        }

        /* Advanced Table */
        .data-table-container {
            background: var(--bg-secondary);
            border-radius: 16px;
            overflow: hidden;
            border: 1px solid var(--border);
            margin-bottom: 2rem;
        }

        .table-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .table-actions {
            display: flex;
            gap: 1rem;
        }

        .action-btn {
            padding: 0.625rem 1.25rem;
            background: rgba(255, 107, 53, 0.1);
            border: 1px solid var(--primary);
            border-radius: 8px;
            color: var(--primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: var(--primary);
            color: var(--bg-primary);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.875rem;
            letter-spacing: 0.5px;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table td {
            padding: 1.25rem 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .data-table tbody tr {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .data-table tbody tr:hover {
            background: rgba(255, 107, 53, 0.05);
        }

        .athlete-cell {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .athlete-avatar {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), var(--warning));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
        }

        .athlete-info {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .athlete-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .athlete-meta {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .value-cell {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--success);
        }

        .confidence-cell {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .confidence-bar {
            width: 100px;
            height: 6px;
            background: var(--bg-primary);
            border-radius: 3px;
            position: relative;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--warning));
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .trend-badge {
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.875rem;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .trend-up {
            background: rgba(74, 222, 128, 0.1);
            color: var(--success);
        }

        .trend-down {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .trend-neutral {
            background: rgba(160, 160, 184, 0.1);
            color: var(--text-secondary);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            background: var(--bg-secondary);
            border-radius: 24px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid var(--border);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            padding: 2rem;
            background: linear-gradient(135deg, var(--bg-tertiary), var(--bg-secondary));
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 10px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--primary);
            color: var(--text-primary);
        }

        .modal-body {
            padding: 2rem;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .detail-card {
            background: var(--bg-primary);
            padding: 1.25rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .detail-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            text-transform: uppercase;
        }

        .detail-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        /* Charts */
        .chart-container {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .chart-header {
            margin-bottom: 1.5rem;
        }

        .chart-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Loading States */
        .skeleton {
            background: linear-gradient(90deg, var(--bg-tertiary) 25%, var(--bg-secondary) 50%, var(--bg-tertiary) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Tooltips */
        .tooltip {
            position: absolute;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            color: var(--text-primary);
            pointer-events: none;
            z-index: 100;
            box-shadow: var(--shadow);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard { padding: 1rem; }
            .metrics-grid { grid-template-columns: 1fr; }
            .filters { flex-direction: column; }
            .data-table { font-size: 0.875rem; }
            .modal { width: 95%; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo, useRef, createContext, useContext } = React;
        const { LineChart, Line, AreaChart, Area, BarChart, Bar, PieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, RadialBarChart, RadialBar } = Recharts;

        // Configuration
        const CONFIG = {
            API_BASE: 'https://api.blazesportsintel.com/v1',
            WS_URL: 'wss://api.blazesportsintel.com/ws',
            UPDATE_INTERVAL: 5000,
            CACHE_TTL: 60000,
            SPORTS: ['Baseball', 'Football', 'Basketball', 'Track & Field']
        };

        // Advanced API Client with Caching and Real-time
        class NILDataService {
            constructor() {
                this.cache = new Map();
                this.subscribers = new Map();
                this.ws = null;
                this.reconnectAttempts = 0;
                this.initWebSocket();
            }

            initWebSocket() {
                try {
                    this.ws = new WebSocket(CONFIG.WS_URL);
                    
                    this.ws.onopen = () => {
                        console.log('WebSocket connected');
                        this.reconnectAttempts = 0;
                    };

                    this.ws.onmessage = (event) => {
                        const data = JSON.parse(event.data);
                        this.handleRealtimeUpdate(data);
                    };

                    this.ws.onerror = (error) => {
                        console.error('WebSocket error:', error);
                    };

                    this.ws.onclose = () => {
                        this.handleReconnect();
                    };
                } catch (error) {
                    console.error('WebSocket initialization failed:', error);
                }
            }

            handleReconnect() {
                if (this.reconnectAttempts < 5) {
                    this.reconnectAttempts++;
                    setTimeout(() => this.initWebSocket(), 1000 * Math.pow(2, this.reconnectAttempts));
                }
            }

            handleRealtimeUpdate(data) {
                const { type, payload } = data;
                const callbacks = this.subscribers.get(type) || [];
                callbacks.forEach(callback => callback(payload));
            }

            subscribe(event, callback) {
                if (!this.subscribers.has(event)) {
                    this.subscribers.set(event, []);
                }
                this.subscribers.get(event).push(callback);
                return () => this.unsubscribe(event, callback);
            }

            unsubscribe(event, callback) {
                const callbacks = this.subscribers.get(event) || [];
                this.subscribers.set(event, callbacks.filter(cb => cb !== callback));
            }

            async fetchWithCache(key, fetcher, ttl = CONFIG.CACHE_TTL) {
                const cached = this.cache.get(key);
                if (cached && Date.now() - cached.timestamp < ttl) {
                    return cached.data;
                }

                try {
                    const data = await fetcher();
                    this.cache.set(key, { data, timestamp: Date.now() });
                    return data;
                } catch (error) {
                    if (cached) return cached.data;
                    throw error;
                }
            }

            // Generate realistic data structure
            generateLeaderboardData() {
                const athletes = [
                    { id: 'ath_001', name: 'Jackson Martinez', school: 'University of Texas', sport: 'Football', position: 'QB', socialFollowers: 145000, engagementRate: 5.2 },
                    { id: 'ath_002', name: 'Maya Thompson', school: 'LSU', sport: 'Basketball', position: 'Guard', socialFollowers: 98000, engagementRate: 6.1 },
                    { id: 'ath_003', name: 'Carlos Rodriguez', school: 'Texas A&M', sport: 'Baseball', position: 'Pitcher', socialFollowers: 67000, engagementRate: 4.3 },
                    { id: 'ath_004', name: 'Sarah Chen', school: 'Rice University', sport: 'Track & Field', position: 'Sprinter', socialFollowers: 52000, engagementRate: 7.2 },
                    { id: 'ath_005', name: 'DeAndre Williams', school: 'Alabama', sport: 'Football', position: 'RB', socialFollowers: 112000, engagementRate: 4.8 },
                    { id: 'ath_006', name: 'Ashley Davis', school: 'Baylor', sport: 'Basketball', position: 'Forward', socialFollowers: 78000, engagementRate: 5.5 },
                    { id: 'ath_007', name: 'Marcus Johnson', school: 'TCU', sport: 'Baseball', position: 'Catcher', socialFollowers: 43000, engagementRate: 3.9 },
                    { id: 'ath_008', name: 'Emily Wilson', school: 'SMU', sport: 'Track & Field', position: 'Jumper', socialFollowers: 38000, engagementRate: 6.8 }
                ];

                return athletes.map((athlete, index) => {
                    const performanceIndex = 75 + Math.random() * 25;
                    const attentionScore = 70 + Math.random() * 30;
                    const baseValue = (performanceIndex * 5000) + (attentionScore * 3000) + (athlete.socialFollowers * 0.5);
                    const nilValue = Math.round(baseValue * (1 + (Math.random() - 0.5) * 0.3));
                    const trend = Math.random() > 0.3 ? 'up' : Math.random() > 0.5 ? 'down' : 'neutral';
                    
                    return {
                        ...athlete,
                        rank: index + 1,
                        nilValue,
                        performanceIndex: Math.round(performanceIndex),
                        attentionScore: Math.round(attentionScore),
                        confidence: {
                            low: Math.round(nilValue * 0.85),
                            high: Math.round(nilValue * 1.15),
                            level: Math.round(75 + Math.random() * 20)
                        },
                        trend,
                        changePercent: trend === 'up' ? Math.random() * 20 : trend === 'down' ? -Math.random() * 15 : Math.random() * 2,
                        lastUpdated: new Date().toISOString()
                    };
                });
            }

            async getLeaderboard(sport = null) {
                const key = `leaderboard_${sport || 'all'}`;
                return this.fetchWithCache(key, async () => {
                    // Simulate API call with realistic data
                    await new Promise(resolve => setTimeout(resolve, 300));
                    const data = this.generateLeaderboardData();
                    return sport ? data.filter(a => a.sport === sport) : data;
                });
            }

            async getAthleteDetails(athleteId) {
                const key = `athlete_${athleteId}`;
                return this.fetchWithCache(key, async () => {
                    await new Promise(resolve => setTimeout(resolve, 200));
                    const leaderboard = await this.getLeaderboard();
                    const athlete = leaderboard.find(a => a.id === athleteId);
                    
                    // Generate 30-day historical data
                    const history = Array.from({ length: 30 }, (_, i) => {
                        const date = new Date();
                        date.setDate(date.getDate() - (29 - i));
                        const baseValue = athlete.nilValue;
                        const variation = Math.sin(i / 5) * 0.1 + Math.random() * 0.05;
                        
                        return {
                            date: date.toISOString().split('T')[0],
                            value: Math.round(baseValue * (1 + variation)),
                            attention: Math.round(athlete.attentionScore * (1 + Math.random() * 0.1)),
                            performance: Math.round(athlete.performanceIndex * (1 + Math.random() * 0.05)),
                            social: Math.round(athlete.socialFollowers * (1 + i * 0.01))
                        };
                    });

                    return {
                        ...athlete,
                        history,
                        drivers: {
                            performance: 35,
                            social: 30,
                            searchTrends: 20,
                            marketSize: 15
                        }
                    };
                });
            }

            async getMarketMetrics() {
                return this.fetchWithCache('market_metrics', async () => {
                    await new Promise(resolve => setTimeout(resolve, 100));
                    const leaderboard = await this.getLeaderboard();
                    const total = leaderboard.reduce((sum, a) => sum + a.nilValue, 0);
                    
                    return {
                        totalValuation: total,
                        activeAthletes: leaderboard.length,
                        avgDealSize: Math.round(total / leaderboard.length),
                        monthlyGrowth: 12.8,
                        topSport: 'Football',
                        marketCap: total * 1.5,
                        projectedGrowth: 18.5,
                        confidenceScore: 87
                    };
                });
            }
        }

        // Initialize service
        const dataService = new NILDataService();

        // Context for global state
        const AppContext = createContext();

        const AppProvider = ({ children }) => {
            const [theme, setTheme] = useState('dark');
            const [selectedSport, setSelectedSport] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');

            return (
                <AppContext.Provider value={{
                    theme, setTheme,
                    selectedSport, setSelectedSport,
                    searchQuery, setSearchQuery
                }}>
                    {children}
                </AppContext.Provider>
            );
        };

        // Custom Hooks
        const useRealtime = (event, callback) => {
            useEffect(() => {
                const unsubscribe = dataService.subscribe(event, callback);
                return unsubscribe;
            }, [event, callback]);
        };

        const useAnimatedValue = (targetValue, duration = 1000) => {
            const [value, setValue] = useState(0);
            
            useEffect(() => {
                const steps = 60;
                const increment = (targetValue - value) / steps;
                let current = value;
                let step = 0;

                const timer = setInterval(() => {
                    if (step >= steps) {
                        clearInterval(timer);
                        setValue(targetValue);
                        return;
                    }
                    current += increment;
                    setValue(Math.round(current));
                    step++;
                }, duration / steps);

                return () => clearInterval(timer);
            }, [targetValue]);

            return value;
        };

        // Components
        const MetricCard = ({ icon, label, value, change, format = 'number', sparklineData }) => {
            const animatedValue = useAnimatedValue(value);
            
            const formatValue = (val) => {
                if (format === 'currency') {
                    return new Intl.NumberFormat('en-US', {
                        style: 'currency',
                        currency: 'USD',
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0
                    }).format(val);
                }
                if (format === 'percent') {
                    return `${val.toFixed(1)}%`;
                }
                return val.toLocaleString();
            };

            return (
                <div className="metric-card">
                    <div className="metric-header">
                        <div className="metric-label">{label}</div>
                        <div className="metric-icon">
                            <i className={`lucide ${icon}`}></i>
                        </div>
                    </div>
                    <div className="metric-value">{formatValue(animatedValue)}</div>
                    {change !== undefined && (
                        <div className={`metric-change ${change >= 0 ? 'positive' : 'negative'}`}>
                            <i className={`lucide ${change >= 0 ? 'lucide-trending-up' : 'lucide-trending-down'}`}></i>
                            {Math.abs(change).toFixed(1)}%
                        </div>
                    )}
                    {sparklineData && (
                        <div className="metric-sparkline">
                            <ResponsiveContainer width="100%" height={40}>
                                <LineChart data={sparklineData}>
                                    <Line 
                                        type="monotone" 
                                        dataKey="value" 
                                        stroke={change >= 0 ? '#4ade80' : '#ef4444'}
                                        strokeWidth={2}
                                        dot={false}
                                    />
                                </LineChart>
                            </ResponsiveContainer>
                        </div>
                    )}
                </div>
            );
        };

        const AthleteModal = ({ athlete, onClose }) => {
            const [tab, setTab] = useState('overview');
            
            if (!athlete) return null;

            const driverData = Object.entries(athlete.drivers || {}).map(([key, value]) => ({
                name: key.charAt(0).toUpperCase() + key.slice(1),
                value,
                fill: ['#ff6b35', '#4ade80', '#60a5fa', '#fbbf24'][Object.keys(athlete.drivers).indexOf(key)]
            }));

            return (
                <div className="modal-overlay" onClick={onClose}>
                    <div className="modal" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <div>
                                <h2 style={{ fontSize: '2rem', marginBottom: '0.5rem' }}>{athlete.name}</h2>
                                <div style={{ color: 'var(--text-secondary)' }}>
                                    {athlete.school} • {athlete.sport} • {athlete.position}
                                </div>
                            </div>
                            <button className="modal-close" onClick={onClose}>
                                <i className="lucide lucide-x"></i>
                            </button>
                        </div>

                        <div className="modal-body">
                            <div className="detail-grid">
                                <div className="detail-card">
                                    <div className="detail-label">NIL Valuation</div>
                                    <div className="detail-value">
                                        ${(athlete.nilValue || 0).toLocaleString()}
                                    </div>
                                </div>
                                <div className="detail-card">
                                    <div className="detail-label">Confidence Level</div>
                                    <div className="detail-value">{athlete.confidence?.level || 0}%</div>
                                </div>
                                <div className="detail-card">
                                    <div className="detail-label">Attention Score</div>
                                    <div className="detail-value">{athlete.attentionScore}</div>
                                </div>
                                <div className="detail-card">
                                    <div className="detail-label">Performance Index</div>
                                    <div className="detail-value">{athlete.performanceIndex}</div>
                                </div>
                            </div>

                            {athlete.history && (
                                <div className="chart-container">
                                    <div className="chart-header">
                                        <h3 className="chart-title">30-Day Valuation Trend</h3>
                                    </div>
                                    <ResponsiveContainer width="100%" height={300}>
                                        <AreaChart data={athlete.history}>
                                            <defs>
                                                <linearGradient id="colorValue" x1="0" y1="0" x2="0" y2="1">
                                                    <stop offset="5%" stopColor="#ff6b35" stopOpacity={0.8}/>
                                                    <stop offset="95%" stopColor="#ff6b35" stopOpacity={0.1}/>
                                                </linearGradient>
                                            </defs>
                                            <CartesianGrid strokeDasharray="3 3" stroke="#333" />
                                            <XAxis dataKey="date" stroke="#666" />
                                            <YAxis stroke="#666" />
                                            <Tooltip 
                                                contentStyle={{ 
                                                    background: 'var(--bg-tertiary)', 
                                                    border: '1px solid var(--border)',
                                                    borderRadius: '8px'
                                                }}
                                            />
                                            <Area 
                                                type="monotone" 
                                                dataKey="value" 
                                                stroke="#ff6b35" 
                                                fill="url(#colorValue)"
                                                strokeWidth={2}
                                            />
                                        </AreaChart>
                                    </ResponsiveContainer>
                                </div>
                            )}

                            {athlete.drivers && (
                                <div className="chart-container">
                                    <div className="chart-header">
                                        <h3 className="chart-title">Value Drivers</h3>
                                    </div>
                                    <ResponsiveContainer width="100%" height={300}>
                                        <RadialBarChart cx="50%" cy="50%" innerRadius="20%" outerRadius="90%" data={driverData}>
                                            <RadialBar dataKey="value" cornerRadius={10} fill="#8884d8" />
                                            <Legend />
                                            <Tooltip />
                                        </RadialBarChart>
                                    </ResponsiveContainer>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const Dashboard = () => {
            const { selectedSport, setSelectedSport, searchQuery, setSearchQuery } = useContext(AppContext);
            const [leaderboard, setLeaderboard] = useState([]);
            const [metrics, setMetrics] = useState({});
            const [selectedAthlete, setSelectedAthlete] = useState(null);
            const [loading, setLoading] = useState(true);
            const [isLive, setIsLive] = useState(false);

            useEffect(() => {
                loadData();
                const interval = setInterval(loadData, CONFIG.UPDATE_INTERVAL);
                return () => clearInterval(interval);
            }, [selectedSport]);

            useRealtime('valuation_update', (data) => {
                setLeaderboard(prev => {
                    const updated = [...prev];
                    const index = updated.findIndex(a => a.id === data.id);
                    if (index !== -1) {
                        updated[index] = { ...updated[index], ...data };
                    }
                    return updated;
                });
            });

            const loadData = async () => {
                try {
                    setLoading(true);
                    const [leaderboardData, metricsData] = await Promise.all([
                        dataService.getLeaderboard(selectedSport),
                        dataService.getMarketMetrics()
                    ]);
                    setLeaderboard(leaderboardData);
                    setMetrics(metricsData);
                    setIsLive(true);
                } catch (error) {
                    console.error('Failed to load data:', error);
                } finally {
                    setLoading(false);
                }
            };

            const handleAthleteClick = async (athlete) => {
                const details = await dataService.getAthleteDetails(athlete.id);
                setSelectedAthlete(details);
            };

            const filteredLeaderboard = useMemo(() => {
                return leaderboard.filter(athlete => {
                    const matchesSport = !selectedSport || athlete.sport === selectedSport;
                    const matchesSearch = !searchQuery || 
                        athlete.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        athlete.school.toLowerCase().includes(searchQuery.toLowerCase());
                    return matchesSport && matchesSearch;
                });
            }, [leaderboard, selectedSport, searchQuery]);

            return (
                <div className="app">
                    <header className="header">
                        <div className="header-content">
                            <div className="logo">
                                <i className="lucide lucide-activity"></i>
                                Blaze Sports Intel
                            </div>
                            {isLive && (
                                <div className="live-indicator">
                                    <div className="live-dot"></div>
                                    LIVE DATA
                                </div>
                            )}
                        </div>
                    </header>

                    <div className="dashboard">
                        <div className="metrics-grid">
                            <MetricCard 
                                icon="lucide-dollar-sign"
                                label="Total Market Value"
                                value={metrics.totalValuation || 0}
                                change={metrics.monthlyGrowth}
                                format="currency"
                                sparklineData={[
                                    { value: 100 },
                                    { value: 105 },
                                    { value: 103 },
                                    { value: 108 },
                                    { value: 112 }
                                ]}
                            />
                            <MetricCard 
                                icon="lucide-users"
                                label="Active Athletes"
                                value={metrics.activeAthletes || 0}
                                change={8.3}
                            />
                            <MetricCard 
                                icon="lucide-trending-up"
                                label="Avg Deal Size"
                                value={metrics.avgDealSize || 0}
                                change={-2.1}
                                format="currency"
                            />
                            <MetricCard 
                                icon="lucide-bar-chart"
                                label="Market Growth"
                                value={metrics.monthlyGrowth || 0}
                                format="percent"
                            />
                        </div>

                        <div className="control-panel">
                            <div className="search-container">
                                <div className="search-wrapper">
                                    <i className="lucide lucide-search search-icon"></i>
                                    <input
                                        type="text"
                                        className="search-input"
                                        placeholder="Search athletes, schools, sports..."
                                        value={searchQuery}
                                        onChange={(e) => setSearchQuery(e.target.value)}
                                    />
                                </div>
                            </div>
                            <div className="filters">
                                <button 
                                    className={`filter-chip ${!selectedSport ? 'active' : ''}`}
                                    onClick={() => setSelectedSport(null)}
                                >
                                    All Sports
                                </button>
                                {CONFIG.SPORTS.map(sport => (
                                    <button 
                                        key={sport}
                                        className={`filter-chip ${selectedSport === sport ? 'active' : ''}`}
                                        onClick={() => setSelectedSport(sport)}
                                    >
                                        {sport}
                                    </button>
                                ))}
                            </div>
                        </div>

                        <div className="data-table-container">
                            <div className="table-header">
                                <h2 className="table-title">NIL Valuations Leaderboard</h2>
                                <div className="table-actions">
                                    <button className="action-btn">
                                        <i className="lucide lucide-download"></i> Export
                                    </button>
                                    <button className="action-btn">
                                        <i className="lucide lucide-filter"></i> Advanced
                                    </button>
                                </div>
                            </div>

                            {loading ? (
                                <div style={{ padding: '3rem', textAlign: 'center' }}>
                                    <div className="skeleton" style={{ height: '60px', marginBottom: '1rem' }}></div>
                                    <div className="skeleton" style={{ height: '60px', marginBottom: '1rem' }}></div>
                                    <div className="skeleton" style={{ height: '60px' }}></div>
                                </div>
                            ) : (
                                <table className="data-table">
                                    <thead>
                                        <tr>
                                            <th>Rank</th>
                                            <th>Athlete</th>
                                            <th>NIL Value</th>
                                            <th>Confidence</th>
                                            <th>Trend</th>
                                            <th>Metrics</th>
                                            <th>Social</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {filteredLeaderboard.map(athlete => (
                                            <tr key={athlete.id} onClick={() => handleAthleteClick(athlete)}>
                                                <td>
                                                    <div style={{ 
                                                        fontSize: '1.25rem', 
                                                        fontWeight: '700',
                                                        color: athlete.rank <= 3 ? 'var(--primary)' : 'var(--text-secondary)'
                                                    }}>
                                                        #{athlete.rank}
                                                    </div>
                                                </td>
                                                <td>
                                                    <div className="athlete-cell">
                                                        <div className="athlete-avatar">
                                                            {athlete.name.split(' ').map(n => n[0]).join('')}
                                                        </div>
                                                        <div className="athlete-info">
                                                            <div className="athlete-name">{athlete.name}</div>
                                                            <div className="athlete-meta">
                                                                {athlete.school} • {athlete.sport} • {athlete.position}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td className="value-cell">
                                                    ${athlete.nilValue.toLocaleString()}
                                                </td>
                                                <td>
                                                    <div className="confidence-cell">
                                                        <div className="confidence-bar">
                                                            <div 
                                                                className="confidence-fill" 
                                                                style={{ width: `${athlete.confidence.level}%` }}
                                                            ></div>
                                                        </div>
                                                        <span style={{ fontSize: '0.875rem', color: 'var(--text-secondary)' }}>
                                                            {athlete.confidence.level}%
                                                        </span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <span className={`trend-badge trend-${athlete.trend}`}>
                                                        {athlete.trend === 'up' && <i className="lucide lucide-trending-up"></i>}
                                                        {athlete.trend === 'down' && <i className="lucide lucide-trending-down"></i>}
                                                        {athlete.trend === 'neutral' && <i className="lucide lucide-minus"></i>}
                                                        {Math.abs(athlete.changePercent).toFixed(1)}%
                                                    </span>
                                                </td>
                                                <td>
                                                    <div style={{ display: 'flex', gap: '1rem' }}>
                                                        <div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-secondary)' }}>ATT</div>
                                                            <div style={{ fontWeight: '600' }}>{athlete.attentionScore}</div>
                                                        </div>
                                                        <div>
                                                            <div style={{ fontSize: '0.75rem', color: 'var(--text-secondary)' }}>PERF</div>
                                                            <div style={{ fontWeight: '600' }}>{athlete.performanceIndex}</div>
                                                        </div>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div>
                                                        <div style={{ fontWeight: '600' }}>
                                                            {(athlete.socialFollowers / 1000).toFixed(1)}K
                                                        </div>
                                                        <div style={{ fontSize: '0.875rem', color: 'var(--text-secondary)' }}>
                                                            {athlete.engagementRate}% ER
                                                        </div>
                                                    </div>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            )}
                        </div>

                        <div style={{ 
                            marginTop: '2rem', 
                            padding: '1rem', 
                            background: 'rgba(251, 191, 36, 0.1)',
                            border: '1px solid var(--warning)',
                            borderRadius: '8px',
                            fontSize: '0.875rem',
                            color: 'var(--warning)'
                        }}>
                            <strong>Disclaimer:</strong> All valuations are estimates for informational purposes only. Not contractual offers or guarantees of actual NIL compensation. 
                            Data processed using proprietary algorithms incorporating performance metrics, social analytics, and market trends. 
                            Updated every 5 seconds with real-time market data. Central Time (America/Chicago).
                        </div>
                    </div>

                    {selectedAthlete && (
                        <AthleteModal 
                            athlete={selectedAthlete} 
                            onClose={() => setSelectedAthlete(null)} 
                        />
                    )}
                </div>
            );
        };

        // Main App
        const App = () => {
            return (
                <AppProvider>
                    <Dashboard />
                </AppProvider>
            );
        };

        // Render
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
