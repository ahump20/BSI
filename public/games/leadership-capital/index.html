<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intangible Leadership Capital Index | BSI</title>
    <meta name="description" content="Quantify the unquantifiable — 23 intangible leadership metrics mapped to 5 validated academic frameworks: Ulrich LCI, ISO 30431, MLQ 5X transformational, TEIQue, and Antonakis CLTs.">

    <!-- Open Graph -->
    <meta property="og:title" content="Intangible Leadership Capital Index | BSI">
    <meta property="og:description" content="23 intangible leadership metrics mapped to 5 validated academic frameworks. Quantify the It Factor.">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Blaze Sports Intel">

    <!-- Fonts: BSI brand system -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Chart.js 4 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <style>
        /* ================================================================
           BSI BRAND TOKENS — Dark Theme + Glass-Morphism
           Derived from lib/tokens/bsi-brand.css
           ================================================================ */
        :root {
            --bsi-primary: #BF5700;
            --bsi-accent: #FF6B35;
            --bsi-surface: #0D0D12;
            --bsi-gold: #FDB913;
            --bsi-text: #FAFAFA;
            --bsi-text-secondary: #a3a3a3;
            --bsi-text-tertiary: #737373;
            --bsi-texas-soil: #8B4513;
            --bsi-charcoal: #1A1A1A;
            --bsi-midnight: #0D0D12;

            --glass-subtle-bg: rgba(255, 255, 255, 0.04);
            --glass-subtle-border: rgba(255, 255, 255, 0.06);
            --glass-default-bg: rgba(255, 255, 255, 0.08);
            --glass-default-border: rgba(255, 255, 255, 0.12);
            --glass-elevated-bg: rgba(255, 255, 255, 0.12);
            --glass-elevated-border: rgba(255, 255, 255, 0.18);

            --bsi-glow-sm: 0 0 20px rgba(191, 87, 0, 0.3);
            --bsi-glow-md: 0 0 40px rgba(191, 87, 0, 0.4), 0 0 60px rgba(191, 87, 0, 0.2);

            --font-display: 'Oswald', system-ui, sans-serif;
            --font-body: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: var(--bsi-midnight);
            font-family: var(--font-body);
            color: var(--bsi-text);
            padding: 1.5rem;
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
        }

        /* ---- Layout ---- */
        .container {
            max-width: 1440px;
            margin: 0 auto;
            background: var(--glass-elevated-bg);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--glass-elevated-border);
            border-radius: 24px;
            padding: 2rem;
        }

        /* ---- Header Banner ---- */
        .header-banner {
            background: linear-gradient(135deg, var(--bsi-primary), var(--bsi-texas-soil));
            border-radius: 16px;
            padding: 1.75rem 2rem;
            margin-bottom: 1.5rem;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .header-banner h1 {
            font-family: var(--font-display);
            font-weight: 700;
            font-size: clamp(1.4rem, 2.5vw, 2rem);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .badge-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .badge {
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(4px);
            padding: 0.45rem 1rem;
            border-radius: 100px;
            border: 1px solid rgba(255, 255, 255, 0.15);
            font-family: var(--font-mono);
            font-weight: 500;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }

        .badge i { color: var(--bsi-gold); }

        /* ---- Framework Mapping Pills ---- */
        .mapping-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            margin-bottom: 2rem;
            font-size: 0.8rem;
        }

        .pill {
            background: rgba(191, 87, 0, 0.12);
            border: 1px solid rgba(191, 87, 0, 0.25);
            padding: 0.3rem 0.9rem;
            border-radius: 100px;
            color: var(--bsi-accent);
            font-weight: 500;
        }

        .pill i { margin-right: 4px; color: var(--bsi-primary); }

        /* ---- Grid System ---- */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.25rem;
            margin-bottom: 2rem;
        }

        /* ---- Cards (Glass) ---- */
        .card {
            background: var(--glass-default-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-default-border);
            border-radius: 16px;
            padding: 1.5rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .card:hover {
            border-color: rgba(191, 87, 0, 0.3);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.25rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .card-header h2 {
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 1.3rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-header h2 i { color: var(--bsi-primary); }

        .card-sub {
            font-family: var(--font-mono);
            font-size: 0.7rem;
            color: var(--bsi-text-secondary);
            background: var(--glass-subtle-bg);
            padding: 0.25rem 0.75rem;
            border-radius: 100px;
            border: 1px solid var(--glass-subtle-border);
        }

        .card-desc {
            color: var(--bsi-text-tertiary);
            font-size: 0.85rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ---- Metric Rows ---- */
        .metric-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.7rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        }

        .metric-item:last-child { border-bottom: none; }

        .metric-info {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            min-width: 0;
        }

        .metric-icon {
            width: 28px;
            text-align: center;
            color: var(--bsi-primary);
            flex-shrink: 0;
        }

        .metric-name {
            font-weight: 500;
            font-size: 0.88rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .framework-tag {
            background: rgba(191, 87, 0, 0.15);
            font-family: var(--font-mono);
            font-size: 0.6rem;
            padding: 2px 7px;
            border-radius: 100px;
            color: var(--bsi-accent);
            font-weight: 600;
            letter-spacing: 0.3px;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .slider-group {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-shrink: 0;
            width: 180px;
        }

        input[type=range] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            outline: none;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--bsi-primary);
            border-radius: 50%;
            border: 2px solid var(--bsi-text);
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(191, 87, 0, 0.4);
            transition: transform 0.15s;
        }

        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.15);
        }

        input[type=range]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--bsi-primary);
            border-radius: 50%;
            border: 2px solid var(--bsi-text);
            cursor: pointer;
        }

        .score-badge {
            min-width: 40px;
            height: 30px;
            background: var(--glass-subtle-bg);
            border: 1px solid var(--glass-subtle-border);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: var(--font-mono);
            font-weight: 700;
            font-size: 0.85rem;
            color: var(--bsi-text);
        }

        /* ---- Section Divider ---- */
        .section-divider {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 0.5rem 0 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .section-divider h3 {
            font-family: var(--font-display);
            font-weight: 700;
            font-size: clamp(1.1rem, 2vw, 1.5rem);
            text-transform: uppercase;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-divider h3 i { color: var(--bsi-gold); }

        /* ---- Buttons ---- */
        .btn {
            background: var(--bsi-primary);
            border: 1px solid rgba(255, 255, 255, 0.15);
            color: white;
            padding: 0.65rem 1.6rem;
            border-radius: 100px;
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            background: var(--bsi-accent);
            box-shadow: var(--bsi-glow-sm);
            transform: translateY(-1px);
        }

        .btn-reset {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.12);
            color: var(--bsi-text-secondary);
        }

        .btn-reset:hover {
            background: rgba(255, 255, 255, 0.06);
            box-shadow: none;
            color: var(--bsi-text);
        }

        /* ---- KPI Panels ---- */
        .kpi-panel {
            background: var(--glass-default-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-default-border);
            border-radius: 16px;
            padding: 1.4rem;
            text-align: center;
            transition: border-color 0.3s, box-shadow 0.3s;
        }

        .kpi-panel:hover {
            border-color: rgba(191, 87, 0, 0.3);
        }

        .kpi-title {
            font-family: var(--font-display);
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--bsi-text-secondary);
            font-weight: 600;
            margin-bottom: 0.3rem;
        }

        .kpi-number {
            font-family: var(--font-mono);
            font-size: clamp(2.5rem, 5vw, 3.5rem);
            font-weight: 700;
            line-height: 1.1;
            color: var(--bsi-text);
        }

        .kpi-unit {
            font-size: 1.2rem;
            color: var(--bsi-text-secondary);
        }

        .kpi-label {
            font-size: 0.75rem;
            color: var(--bsi-text-tertiary);
            margin-top: 0.3rem;
        }

        .kpi-tag {
            display: inline-block;
            font-family: var(--font-mono);
            font-size: 0.65rem;
            background: rgba(191, 87, 0, 0.2);
            color: var(--bsi-accent);
            padding: 3px 10px;
            border-radius: 100px;
            margin-top: 0.5rem;
        }

        /* IT Factor special glow */
        .kpi-it-factor {
            border-color: rgba(191, 87, 0, 0.4);
            box-shadow: var(--bsi-glow-sm);
            background: linear-gradient(145deg, rgba(191, 87, 0, 0.08), var(--glass-default-bg));
        }

        .kpi-it-factor:hover {
            box-shadow: var(--bsi-glow-md);
        }

        .kpi-it-factor .kpi-number {
            color: var(--bsi-accent);
        }

        /* ---- Chart Containers ---- */
        .chart-card {
            background: var(--glass-default-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--glass-default-border);
            border-radius: 16px;
            padding: 1.5rem;
        }

        .chart-header {
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.75rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .chart-card canvas {
            max-height: 320px;
            width: 100% !important;
        }

        .chart-note {
            font-size: 0.75rem;
            color: var(--bsi-text-tertiary);
            margin-top: 0.75rem;
            font-style: italic;
        }

        /* ---- Methodology Panel ---- */
        .methodology {
            background: var(--glass-subtle-bg);
            border: 1px solid var(--glass-subtle-border);
            border-left: 4px solid var(--bsi-primary);
            border-radius: 12px;
            margin-top: 2rem;
            overflow: hidden;
        }

        .methodology-toggle {
            width: 100%;
            background: none;
            border: none;
            color: var(--bsi-text);
            font-family: var(--font-display);
            font-size: 1rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            padding: 1.25rem 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background 0.2s;
        }

        .methodology-toggle:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        .methodology-toggle .chevron {
            transition: transform 0.3s;
        }

        .methodology-toggle[aria-expanded="true"] .chevron {
            transform: rotate(180deg);
        }

        .methodology-content {
            padding: 0 1.5rem 1.5rem;
            display: none;
            color: var(--bsi-text-secondary);
            font-size: 0.85rem;
            line-height: 1.7;
        }

        .methodology-content.open {
            display: block;
        }

        .method-heading {
            font-family: var(--font-display);
            font-size: 0.95rem;
            text-transform: uppercase;
            color: var(--bsi-text);
            margin: 1.25rem 0 0.5rem;
            letter-spacing: 0.5px;
        }

        .method-heading:first-child {
            margin-top: 0;
        }

        .methodology-content code {
            font-family: var(--font-mono);
            font-size: 0.78rem;
            background: rgba(191, 87, 0, 0.1);
            padding: 1px 6px;
            border-radius: 4px;
            color: var(--bsi-accent);
        }

        .methodology-content ul {
            padding-left: 1.5rem;
            margin: 0.4rem 0;
        }

        .methodology-content li {
            margin: 0.25rem 0;
        }

        .citation {
            font-family: var(--font-mono);
            font-size: 0.72rem;
            color: var(--bsi-text-tertiary);
            padding: 0.5rem 0;
            border-top: 1px solid rgba(255, 255, 255, 0.04);
        }

        /* ---- Footer ---- */
        .footer {
            text-align: center;
            padding: 1.5rem 0 0.5rem;
            font-size: 0.72rem;
            color: var(--bsi-text-tertiary);
            border-top: 1px solid rgba(255, 255, 255, 0.04);
            margin-top: 2rem;
        }

        /* ---- Responsive ---- */
        @media (max-width: 1000px) {
            .grid-2 { grid-template-columns: 1fr; }
            .grid-4 { grid-template-columns: 1fr 1fr; }
        }

        @media (max-width: 640px) {
            body { padding: 0.75rem; }
            .container { padding: 1rem; border-radius: 16px; }
            .header-banner { padding: 1.25rem; }
            .grid-4 { grid-template-columns: 1fr; }
            .metric-item { flex-wrap: wrap; gap: 0.5rem; }
            .slider-group { width: 100%; }
            .framework-tag { display: none; }
        }

        /* ---- Score Color Coding ---- */
        .score-badge.score-low { color: #f87171; border-color: rgba(248, 113, 113, 0.3); }
        .score-badge.score-mid { color: #fbbf24; border-color: rgba(251, 191, 36, 0.3); }
        .score-badge.score-high { color: #4ade80; border-color: rgba(74, 222, 128, 0.3); }

        /* ---- KPI Interpretation Label ---- */
        .kpi-interpretation {
            font-family: var(--font-display);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-top: 0.4rem;
            font-weight: 600;
        }
        .kpi-interpretation.tier-developing { color: #f87171; }
        .kpi-interpretation.tier-competent { color: #fbbf24; }
        .kpi-interpretation.tier-strong { color: #4ade80; }
        .kpi-interpretation.tier-elite { color: var(--bsi-accent); }

        /* ---- KPI Number Transition ---- */
        .kpi-number {
            transition: color 0.3s;
        }

        /* ---- Preset Buttons ---- */
        .preset-bar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        .preset-btn {
            background: var(--glass-subtle-bg);
            border: 1px solid var(--glass-subtle-border);
            border-radius: 100px;
            padding: 0.5rem 1.2rem;
            font-family: var(--font-display);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--bsi-text-secondary);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }
        .preset-btn:hover {
            background: rgba(191, 87, 0, 0.15);
            border-color: rgba(191, 87, 0, 0.3);
            color: var(--bsi-accent);
        }
        .preset-btn.active {
            background: rgba(191, 87, 0, 0.2);
            border-color: var(--bsi-primary);
            color: var(--bsi-accent);
        }

        /* ---- Export/Import Bar ---- */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        .tool-btn {
            background: var(--glass-subtle-bg);
            border: 1px solid var(--glass-subtle-border);
            border-radius: 8px;
            padding: 0.4rem 0.9rem;
            font-family: var(--font-mono);
            font-size: 0.7rem;
            color: var(--bsi-text-tertiary);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }
        .tool-btn:hover {
            background: rgba(191, 87, 0, 0.1);
            color: var(--bsi-text-secondary);
        }
        .tool-btn i { font-size: 0.65rem; }

        /* ---- Bar Chart Container ---- */
        .bar-chart-row {
            margin-top: 1.5rem;
        }

        /* ---- Reduced motion ---- */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                transition-duration: 0.01ms !important;
            }
        }

        /* ---- Print ---- */
        @media print {
            body { background: white; color: black; padding: 0; }
            .container { border: none; background: white; backdrop-filter: none; }
            .header-banner { background: #BF5700 !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
            .card, .kpi-panel, .chart-card, .methodology { background: #f5f5f5; border: 1px solid #ddd; backdrop-filter: none; }
            .btn, .btn-reset, .preset-btn, .tool-btn { display: none; }
            input[type=range] { display: none; }
            .methodology-content { display: block !important; }
            canvas { max-height: 250px; }
        }
    </style>
</head>
<body>
<div class="container">

    <!-- ============================================================
         HEADER BANNER
         ============================================================ -->
    <div class="header-banner">
        <h1>
            <i class="fas fa-chart-line"></i>
            Intangible Leadership Capital Index
        </h1>
        <div class="badge-group">
            <span class="badge"><i class="fas fa-flask"></i> Ulrich LCI 2015</span>
            <span class="badge"><i class="fas fa-certificate"></i> ISO/TS 30431</span>
            <span class="badge"><i class="fas fa-brain"></i> Bass &amp; Avolio MLQ</span>
            <span class="badge"><i class="fas fa-heart-pulse"></i> TEIQue</span>
            <span class="badge"><i class="fas fa-bolt"></i> Antonakis CLTs</span>
        </div>
    </div>

    <!-- ============================================================
         FRAMEWORK MAPPING PILLS
         ============================================================ -->
    <div class="mapping-pills">
        <span class="pill"><i class="fas fa-arrow-right"></i> Personal Proficiency &#8594; Cognitive Efficiency, Resilience, Neural Adaptability (Ulrich)</span>
        <span class="pill"><i class="fas fa-arrow-right"></i> Trust (ISO 30431) &#8594; Empathy, Communication, Sentiment, Feedback</span>
        <span class="pill"><i class="fas fa-arrow-right"></i> Synergy Model &#8594; Geometric mean of 4 pillars penalizes weak links</span>
        <span class="pill"><i class="fas fa-arrow-right"></i> Trust Cap &#8594; Low trust score constrains &#8220;It Factor&#8221; ceiling</span>
    </div>

    <!-- ============================================================
         PRESET PROFILES + TOOLBAR
         ============================================================ -->
    <div class="preset-bar" id="presetBar">
        <button class="preset-btn" data-preset="visionary"><i class="fas fa-eye"></i> The Visionary</button>
        <button class="preset-btn" data-preset="executor"><i class="fas fa-gears"></i> The Executor</button>
        <button class="preset-btn" data-preset="connector"><i class="fas fa-handshake"></i> The Connector</button>
    </div>
    <div class="toolbar">
        <button class="tool-btn" id="exportBtn"><i class="fas fa-download"></i> Export JSON</button>
        <button class="tool-btn" id="importBtn"><i class="fas fa-upload"></i> Import JSON</button>
        <input type="file" id="importFile" accept=".json" style="display:none">
    </div>

    <!-- ============================================================
         METRICS GRID — Two-Column (Individual + Organizational)
         ============================================================ -->
    <div class="grid-2">
        <!-- LEFT: Individual Leadership Capital -->
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-user-astronaut"></i> Individual Capital</h2>
                <span class="card-sub">Ulrich Individual + MLQ + TEIQue</span>
            </div>
            <div class="card-desc">
                <i class="fas fa-microchip"></i> Personal proficiency, strategist, executor, talent brand
            </div>
            <div id="individual-metrics"></div>
        </div>

        <!-- RIGHT: Organizational & ISO Cluster -->
        <div class="card">
            <div class="card-header">
                <h2><i class="fas fa-building-columns"></i> Organizational Cluster</h2>
                <span class="card-sub">Ulrich Org + ISO 30431</span>
            </div>
            <div class="card-desc">
                <i class="fas fa-people-arrows"></i> Culture, trust, talent flow, accountability, work practices
            </div>
            <div id="organizational-metrics"></div>
        </div>
    </div>

    <!-- ============================================================
         SECTION DIVIDER
         ============================================================ -->
    <div class="section-divider">
        <h3><i class="fas fa-crown"></i> The "It" Factor: Quantifying the Unquantifiable</h3>
        <div style="display:flex; gap:0.5rem; flex-wrap:wrap;">
            <button class="btn" id="recalcBtn"><i class="fas fa-rotate"></i> Recalculate</button>
            <button class="btn btn-reset" id="resetBtn"><i class="fas fa-arrow-rotate-left"></i> Reset All</button>
        </div>
    </div>

    <!-- ============================================================
         KPI DASHBOARD — 4 Panels
         ============================================================ -->
    <div class="grid-4">
        <div class="kpi-panel">
            <div class="kpi-title">Ulrich LCI</div>
            <div class="kpi-number" id="kpi-ulrich">&#8212;</div>
            <div class="kpi-interpretation" id="interp-ulrich"></div>
            <div class="kpi-label">Individual + Organizational composite</div>
            <span class="kpi-tag">10-factor weighted</span>
        </div>
        <div class="kpi-panel">
            <div class="kpi-title">ISO 30431</div>
            <div class="kpi-number" id="kpi-iso">&#8212;</div>
            <div class="kpi-interpretation" id="interp-iso"></div>
            <div class="kpi-label">Trust &#183; Development &#183; Span</div>
            <span class="kpi-tag">3-pillar cluster</span>
        </div>
        <div class="kpi-panel">
            <div class="kpi-title">MLQ Transformational</div>
            <div class="kpi-number" id="kpi-mlq">&#8212;</div>
            <div class="kpi-interpretation" id="interp-mlq"></div>
            <div class="kpi-label">Bass &amp; Avolio 5-factor</div>
            <span class="kpi-tag">IIA &#183; IIB &#183; IM &#183; IS &#183; IC</span>
        </div>
        <div class="kpi-panel kpi-it-factor">
            <div class="kpi-title">It Factor</div>
            <div class="kpi-number" id="kpi-it">&#8212;</div>
            <div class="kpi-interpretation" id="interp-it"></div>
            <div class="kpi-label">Synergy &#215; coherence, trust-capped</div>
            <span class="kpi-tag">synergy + coherence &#183; trust-aware</span>
            <div id="it-composition" class="kpi-composition" style="font-family:var(--font-mono);font-size:0.65rem;color:var(--bsi-text-tertiary);margin-top:0.3rem;letter-spacing:0.5px;"></div>
        </div>
    </div>

    <!-- ============================================================
         RADAR CHARTS — Ulrich 10-Factor + MLQ 5-Factor
         ============================================================ -->
    <div class="grid-2">
        <div class="chart-card">
            <div class="chart-header">
                <span><i class="fas fa-chart-pie" style="color:var(--bsi-primary);"></i> Ulrich LCI Audit Profile</span>
                <span class="card-sub">10 dimensions</span>
            </div>
            <canvas id="radarUlrich"></canvas>
            <p class="chart-note">5 Individual (Personal, Strategic, Execution, People, Brand) + 5 Organizational (Culture, Talent Flow, Accountability, Information, Work Practices) per Ulrich (2015).</p>
        </div>
        <div class="chart-card">
            <div class="chart-header">
                <span><i class="fas fa-diagram-project" style="color:var(--bsi-primary);"></i> MLQ Transformational Profile</span>
                <span class="card-sub">5 factors</span>
            </div>
            <canvas id="radarMLQ"></canvas>
            <p class="chart-note">Idealized Influence (Attributed + Behavioral), Inspirational Motivation, Intellectual Stimulation, Individualized Consideration per Bass &amp; Avolio (2004).</p>
        </div>
    </div>

    <!-- ============================================================
         IT FACTOR CLUSTER BREAKDOWN — Horizontal Bar Chart
         ============================================================ -->
    <div class="bar-chart-row">
        <div class="chart-card">
            <div class="chart-header">
                <span><i class="fas fa-crown" style="color:var(--bsi-accent);"></i> It Factor Pillar Breakdown</span>
                <span class="card-sub">synergy + coherence</span>
            </div>
            <canvas id="barItClusters"></canvas>
            <p class="chart-note">Four research-backed pillars feed a synergy + coherence model. The geometric mean penalizes imbalance (one weak pillar drags the score); the coherence bonus rewards consistency across all four. A trust-aware cap constrains the ceiling when the ISO trust proxy falls below threshold.</p>
        </div>
    </div>

    <!-- ============================================================
         METHODOLOGY — Expandable Panel
         ============================================================ -->
    <div class="methodology">
        <button class="methodology-toggle" id="methodToggle" aria-expanded="false" aria-controls="methodContent">
            <span><i class="fas fa-book-open" style="color:var(--bsi-primary); margin-right:8px;"></i> Methodology &amp; Academic Validation</span>
            <i class="fas fa-chevron-down chevron"></i>
        </button>
        <div class="methodology-content" id="methodContent" aria-hidden="true">

            <h5 class="method-heading">Conceptual Framework</h5>
            <p>This prototype maps 23 intangible leadership metrics to five validated academic and industry frameworks. The mapping is <strong>conceptual</strong> &#8212; it bridges novel metrics to established constructs based on shared theoretical domains, not direct psychometric equivalence. The goal is to demonstrate that these intangible qualities have legitimate measurement foundations, not to claim factor-analytic identity with existing instruments.</p>

            <h5 class="method-heading">Ulrich Leadership Capital Index (2015)</h5>
            <p>Dave Ulrich's LCI provides a 10-factor model (5 individual + 5 organizational) for assessing leadership quality. Research shows 25&#8211;30% of investment decisions weigh leadership intangibles. Our 23 metrics distribute across all 10 factors using a many-to-many crosswalk (one metric can inform multiple factors):</p>
            <ul>
                <li><strong>Personal Proficiency</strong> &#8592; Cognitive Efficiency, Resilience, Neural Flow Access, Cognitive Elasticity, Neural Adaptability</li>
                <li><strong>Strategic Proficiency</strong> &#8592; Strategic Impact, Visionary Leadership, Narrative Intelligence</li>
                <li><strong>Execution Proficiency</strong> &#8592; Communication Effectiveness, Influence Dynamics, Dynamic Goal Setting, Habit Tracker</li>
                <li><strong>People Proficiency</strong> &#8592; Empathy Index, Team Sentiment, Cross-Mentorship, Reverse Mentoring, Inter-Team Feedback, Micro-Skills</li>
                <li><strong>Leadership Brand</strong> &#8592; Leadership Storytelling, Visionary Leadership, Narrative Intelligence</li>
                <li><strong>Culture Capability</strong> &#8592; Team Sentiment, Leadership Storytelling, Leadership Challenge, Inter-Team Feedback</li>
                <li><strong>Talent Flow</strong> &#8592; Cross-Mentorship, Reverse Mentoring, Micro-Skills, Leadership Simulation, Skill Badges</li>
                <li><strong>Performance Accountability</strong> &#8592; Dynamic Goal Setting, Habit Tracker, Inter-Team Feedback</li>
                <li><strong>Information</strong> &#8592; Narrative Intelligence, Shadowing &amp; Observational Data, Team Sentiment</li>
                <li><strong>Work Practices</strong> &#8592; Leadership Simulation, Leadership Challenge, Cognitive Elasticity, Neural Adaptability</li>
            </ul>
            <p>Composite: <code>LCI = avg(5 individual factors) &#215; 0.5 + avg(5 organizational factors) &#215; 0.5</code></p>

            <h5 class="method-heading">ISO/TS 30431:2021 &#8212; Leadership Metrics</h5>
            <p>Part of the ISO 30414:2018 human capital reporting standard, the leadership metrics cluster measures three pillars. ISO 30414 explicitly defines human capital as the workforce&#8217;s cumulative knowledge, skills, and abilities and frames standardized reporting as a container for non-financial leadership value:</p>
            <ul>
                <li><strong>Trust (40%)</strong> &#8592; Empathy Index, Communication Effectiveness, Real-Time Team Sentiment, Inter-Team Feedback</li>
                <li><strong>Leadership Development (40%)</strong> &#8592; Micro-Skills Curriculum, Leadership Simulation, Cross-Mentorship, Reverse Mentoring, Skill Badges, Habit Tracker, Shadowing</li>
                <li><strong>Span of Control (20%)</strong> &#8592; Cross-Mentorship, Influence Dynamics, Dynamic Goal Setting</li>
            </ul>
            <p>The trust proxy also serves as the <strong>trust-aware cap</strong> on the It Factor score: if the ISO trust proxy falls below 45, the maximum It Factor is capped at 6.0/10 &#8212; reflecting that charisma without trust is fragile (Mayer, Davis &amp; Schoorman, 1995).</p>

            <h5 class="method-heading">Bass &amp; Avolio MLQ 5X &#8212; Transformational Leadership</h5>
            <p>The Multifactor Leadership Questionnaire (1985, revised 2004) identifies five transformational factors:</p>
            <ul>
                <li><strong>Idealized Influence (Attributed)</strong> &#8592; Visionary Leadership, Resilience Coefficient</li>
                <li><strong>Idealized Influence (Behavioral)</strong> &#8592; Influence Dynamics, Leadership Storytelling</li>
                <li><strong>Inspirational Motivation</strong> &#8592; Strategic Impact, Communication, Narrative Intelligence</li>
                <li><strong>Intellectual Stimulation</strong> &#8592; Cognitive Efficiency, Neural Flow Access, Cognitive Elasticity</li>
                <li><strong>Individualized Consideration</strong> &#8592; Empathy Index, Cross-Mentorship, Reverse Mentoring</li>
            </ul>

            <h5 class="method-heading">The &#8220;It&#8221; Factor Algorithm &#8212; Synergy + Coherence Model</h5>
            <p>The &#8220;It Factor&#8221; is modeled as a <strong>latent construct</strong>: an underlying leadership presence inferred from multiple imperfect indicators. This is the only academically defensible path to &#8220;quantifying the unquantifiable&#8221; &#8212; it acknowledges that any score is an inference with uncertainty, not a direct reading like height or heart rate.</p>

            <p><strong>Four research-backed pillars (0&#8211;100 each):</strong></p>
            <ul>
                <li><strong>Adaptability/Focus</strong>: Cognitive Efficiency, Neural Flow Access, Cognitive Elasticity, Neural Adaptability, Resilience Coefficient</li>
                <li><strong>Trust/Influence</strong>: Empathy Index, Communication Effectiveness, Influence Dynamics, Real-Time Team Sentiment</li>
                <li><strong>Meaning/Narrative</strong>: Visionary Leadership, Narrative Intelligence, Leadership Storytelling</li>
                <li><strong>Execution/Alignment</strong>: Strategic Impact, Dynamic Goal Setting, Leadership Habit Tracker</li>
            </ul>

            <p><strong>Scoring model:</strong></p>
            <ul>
                <li><strong>Synergy</strong> = geometric mean of pillars. A geometric mean penalizes weak links: a leader scoring [80, 80, 80, 20] gets ~52, not 65 from an arithmetic mean. This reflects that one catastrophically weak pillar undermines the whole &#8212; consistent with trust models where weakness in one component constrains trust (Mayer et al., 1995).</li>
                <li><strong>Coherence</strong> = 100 &#8722; (std dev of pillars &#215; 1.35). &#8220;It&#8221; often manifests as integration &#8212; consistent signal across cognition, narrative, trust, and execution. Lower variance → higher coherence. This matches how sensemaking literature frames leadership as producing a plausible map that holds together across action and conversation (Weick, 1995).</li>
                <li><strong>Trust Cap</strong>: If ISO trust proxy &lt; 45 → cap at 6.0; &lt; 60 → cap at 8.0; else uncapped (10.0). Prevents high scores when trust foundation is absent.</li>
                <li><strong>It Factor (0&#8211;10)</strong> = min(10 &#215; (0.7 &#215; Synergy + 0.3 &#215; Coherence) / 100, trustCap)</li>
            </ul>

            <p>This is a <strong>formative construct model</strong> &#8212; the indicators <em>create</em> the construct, rather than the construct <em>causing</em> the indicators. Naming this explicitly avoids measurement-model misspecification, a known source of invalid inference. The weights (0.7/0.3, cap thresholds) are starting-point modeling choices that can be calibrated via criterion validity once empirical data is collected. Modern testing standards endorse exactly this pattern: start with an interpretation, then accumulate evidence supporting or revising it.</p>

            <h5 class="method-heading">Validation Anchors</h5>
            <p>The 23-metric system can be &#8220;validated&#8221; in two complementary senses:</p>
            <ul>
                <li><strong>Academic validation</strong> means the measurement has evidence for reliability and validity for stated uses, consistent with modern testing standards (quality of evidence, intended interpretation, appropriate use limits).</li>
                <li><strong>Industry validation</strong> means the measurement maps into recognized reporting and valuation frameworks that organizations and stakeholders already accept as legitimate containers for non-financial leadership value.</li>
            </ul>
            <p>Key anchors:</p>
            <ul>
                <li><strong>ISO 30414:2018</strong> &#8212; Human capital reporting standard. Defines human capital in terms of cumulative knowledge/skills/abilities and frames standardized reporting as improving transparency of human-capital-related value and risk.</li>
                <li><strong>Leadership Capital Index</strong> &#8212; Ulrich's two-domain model (individual capabilities + organizational capabilities leaders build) provides the 10-factor structure for our radar chart.</li>
                <li><strong>Integrative Trust Model</strong> &#8212; Mayer, Davis &amp; Schoorman (1995) established that trustworthiness is multi-component (ability/benevolence/integrity). Weakness in one component constrains trust &#8212; which motivates our trust-cap on the It Factor.</li>
                <li><strong>Sensemaking Theory</strong> &#8212; Weick (1995) frames leadership as producing a plausible map that holds together across action and conversation &#8212; which motivates our coherence bonus (inverse of pillar dispersion).</li>
                <li><strong>Integrated Reporting</strong> &#8212; The IFRS Foundation&#8217;s <em>International &lt;IR&gt; Framework</em> uses a capitals-based approach connecting financial reporting with broader value creation (including human and social/relationship capital), providing a governance-friendly narrative space for leadership &#8220;It Factor&#8221; reporting.</li>
                <li><strong>SEC Regulation S&#8209;K</strong> &#8212; The SEC modernized Regulation S&#8209;K Item 101 to include disclosure of human capital resources to the extent material, an example of how &#8220;people and leadership&#8221; are increasingly treated as decision-relevant corporate information.</li>
            </ul>

            <h5 class="method-heading">Sports Leadership Foundations</h5>
            <p>While the core frameworks above derive from organizational psychology, BSI&#8217;s application targets athletic leadership specifically. The following sports-specific research validates the metric domains:</p>
            <ul>
                <li><strong>Coaching Leadership Behaviors</strong> &#8592; Chelladurai &amp; Saleh (1980) identified 5 dimensions of sports leadership &#8212; Training/Instruction, Democratic Behavior, Autocratic Behavior, Social Support, and Positive Feedback &#8212; directly mapping to our Communication, Empathy, and Influence metrics.</li>
                <li><strong>Athlete Leadership as Shared Process</strong> &#8592; Fransen et al. (2014) demonstrated that leadership in sports teams is distributed, not concentrated in the captain. Their 4-role classification (task, motivational, social, external leader) validates our cross-mentorship, inter-team feedback, and influence dynamics metrics.</li>
                <li><strong>Flow in Athletic Performance</strong> &#8592; Jackson &amp; Csikszentmihalyi (1999) applied flow theory specifically to sport, identifying conditions for optimal athletic experience. This grounds our Neural Flow Access, Cognitive Elasticity, and Neural Adaptability metrics in sports science rather than purely organizational psychology.</li>
                <li><strong>Coaching Psychological Attributes</strong> &#8592; Hodgson et al. (2017) identified 9 elite coaching attributes including resilience, confidence, focus, and emotional awareness/management. These map directly to our Resilience Coefficient, Cognitive Efficiency, and Empathy Index.</li>
                <li><strong>Transformational Leadership in Sports Teams</strong> &#8592; Mach et al. (2022) confirmed that transformational leadership indirectly drives objective team performance through cohesion, validating our MLQ-based scoring approach for athletic contexts.</li>
                <li><strong>Shared &amp; Distributed Leadership</strong> &#8592; Cotterill &amp; Fransen (2016) reviewed the athlete leadership literature, establishing that leadership quality in sports teams depends on distributed capabilities across the roster &#8212; supporting our organizational metrics cluster (mentoring, feedback, challenges).</li>
            </ul>

            <h5 class="method-heading">References</h5>
            <div class="citation">Antonakis, J., Fenley, M., &amp; Liechti, S. (2011). Can charisma be taught? Tests of two interventions. <em>Academy of Management Learning &amp; Education</em>, 10(3), 374&#8211;396. doi:10.5465/amle.2010.0012</div>
            <div class="citation">Bass, B.M., &amp; Avolio, B.J. (2004). <em>Multifactor Leadership Questionnaire Manual and Sampler Set</em> (3rd ed.). Mind Garden.</div>
            <div class="citation">Chelladurai, P., &amp; Saleh, S.D. (1980). Dimensions of leader behavior in sports: Development of a leadership scale. <em>Journal of Sport Psychology</em>, 2(1), 34&#8211;45.</div>
            <div class="citation">Cotterill, S.T., &amp; Fransen, K. (2016). Athlete leadership in sport teams: Current understanding and future directions. <em>International Review of Sport and Exercise Psychology</em>, 9(1), 116&#8211;133. doi:10.1080/1750984X.2015.1124443</div>
            <div class="citation">Csikszentmihalyi, M. (1990). <em>Flow: The Psychology of Optimal Experience</em>. Harper &amp; Row.</div>
            <div class="citation">Fransen, K., Vanbeselaere, N., De Cuyper, B., Vande Broek, G., &amp; Boen, F. (2014). The myth of the team captain as principal leader: Extending the athlete leadership classification within sport teams. <em>Journal of Sports Sciences</em>, 32(14), 1389&#8211;1397. doi:10.1080/02640414.2014.891291</div>
            <div class="citation">Hodgson, L., Butt, J., &amp; Maynard, I. (2017). Exploring the psychological attributes underpinning elite sports coaching. <em>International Journal of Sports Science &amp; Coaching</em>, 12(4), 439&#8211;451. doi:10.1177/1747954117718017</div>
            <div class="citation">IFRS Foundation (2021). <em>International &lt;IR&gt; Framework</em>. Value Reporting Foundation.</div>
            <div class="citation">ISO (2018). ISO 30414:2018 &#8212; Human resource management &#8212; Guidelines for internal and external human capital reporting.</div>
            <div class="citation">ISO (2021). ISO/TS 30431:2021 &#8212; Human resource management &#8212; Leadership metrics cluster. ISO TC 260.</div>
            <div class="citation">Jackson, S.A., &amp; Csikszentmihalyi, M. (1999). <em>Flow in Sports: The Keys to Optimal Experiences and Performances</em>. Human Kinetics.</div>
            <div class="citation">Mach, M., Ferreira, A.I., &amp; Abrantes, A.C. (2022). Transformational leadership and team performance in sports teams: A conditional indirect model. <em>Applied Psychology</em>, 71(2), 662&#8211;694. doi:10.1111/apps.12342</div>
            <div class="citation">Mayer, R.C., Davis, J.H., &amp; Schoorman, F.D. (1995). An integrative model of organizational trust. <em>Academy of Management Review</em>, 20(3), 709&#8211;734. doi:10.5465/amr.1995.9508080335</div>
            <div class="citation">Petrides, K.V., &amp; Furnham, A. (2003). Trait emotional intelligence: Behavioural validation in two studies of emotion recognition and reactivity to mood induction. <em>European Journal of Personality</em>, 17, 39&#8211;57.</div>
            <div class="citation">Ulrich, D. (2015). <em>The Leadership Capital Index: Realizing the Market Value of Leadership</em>. Berrett-Koehler Publishers.</div>
            <div class="citation">Weick, K.E. (1995). <em>Sensemaking in Organizations</em>. Sage Publications.</div>
            <div class="citation">Wong, C.S., &amp; Law, K.S. (2002). The effects of leader and follower emotional intelligence on performance and attitude. <em>The Leadership Quarterly</em>, 13(3), 243&#8211;274.</div>
            <div class="citation">Zadorozhny, K., &amp; Petrides, K.V. (2025). Predicting leadership status through trait emotional intelligence and cognitive ability. <em>Behavioral Sciences</em>, 15(3), 365.</div>
        </div>
    </div>

    <!-- ============================================================
         FOOTER
         ============================================================ -->
    <div class="footer">
        <p>Blaze Sports Intel &#8212; Intangible Leadership Capital Index Prototype</p>
        <p>23 metrics mapped to Ulrich LCI, ISO 30414/30431, MLQ 5X, TEIQue, Antonakis CLTs. Synergy + coherence &#8220;It Factor&#8221; model with trust-aware cap.</p>
        <p style="margin-top:0.5rem;">Evidence-based conceptual validation tool &#8212; not a substitute for psychometric assessment. Scores are structured estimates, not universal truths.</p>
    </div>

</div>

<!-- ================================================================
     JAVASCRIPT — Scoring Engine + Chart Rendering
     All DOM construction uses safe methods (createElement/textContent).
     No innerHTML — all content derives from hardcoded metric arrays.
     ================================================================ -->
<script>
(function () {
    'use strict';

    // ================================================================
    // METRIC DATA — 23 metrics with framework tags and default values
    // ================================================================

    var INDIVIDUAL_METRICS = [
        { id: 'cognitive-efficiency',     name: 'Cognitive Efficiency',         icon: 'fa-brain',                    base: 72, tag: 'Ulrich: Personal' },
        { id: 'strategic-impact',         name: 'Strategic Impact',             icon: 'fa-bullseye',                 base: 78, tag: 'MLQ: Inspirational' },
        { id: 'resilience-coefficient',   name: 'Resilience Coefficient',       icon: 'fa-shield-halved',            base: 70, tag: 'TEIQue: Well-being' },
        { id: 'empathy-index',            name: 'Empathy Index',                icon: 'fa-heart',                    base: 65, tag: 'ISO: Trust' },
        { id: 'communication',            name: 'Communication Effectiveness',  icon: 'fa-comments',                 base: 80, tag: 'Antonakis CLTs' },
        { id: 'influence-dynamics',       name: 'Influence Dynamics',           icon: 'fa-people-group',             base: 73, tag: 'MLQ: Idealized (B)' },
        { id: 'visionary-leadership',     name: 'Visionary Leadership',         icon: 'fa-eye',                      base: 82, tag: 'Ulrich: Strategist' },
        { id: 'neural-flow',             name: 'Neural Flow Access',           icon: 'fa-wave-square',              base: 58, tag: 'Flow: Csikszentmihalyi' },
        { id: 'cognitive-elasticity',     name: 'Cognitive Elasticity',         icon: 'fa-arrow-right-arrow-left',   base: 61, tag: 'MLQ: Intellectual Stim.' },
        { id: 'neural-adaptability',      name: 'Neural Adaptability',          icon: 'fa-microchip',                base: 66, tag: 'TEIQue: Adaptability' },
        { id: 'narrative-intelligence',   name: 'Narrative Intelligence',       icon: 'fa-book-open',                base: 69, tag: 'Antonakis: Metaphor' },
        { id: 'leadership-storytelling',  name: 'Leadership Storytelling',      icon: 'fa-star',                     base: 71, tag: 'Ulrich: Brand' }
    ];

    var ORGANIZATIONAL_METRICS = [
        { id: 'shadowing',               name: 'Shadowing & Observational Data', icon: 'fa-clipboard',              base: 64, tag: 'ISO: Development' },
        { id: 'okrs',                    name: 'Dynamic Goal Setting (OKRs)',    icon: 'fa-flag',                   base: 75, tag: 'Ulrich: Accountability' },
        { id: 'team-sentiment',          name: 'Real-Time Team Sentiment',       icon: 'fa-face-smile',             base: 67, tag: 'ISO: Trust' },
        { id: 'leadership-challenge',    name: 'Leadership Challenge',           icon: 'fa-puzzle-piece',           base: 62, tag: 'Ulrich: Work Practices' },
        { id: 'leadership-simulation',   name: 'Leadership Simulation',          icon: 'fa-gamepad',                base: 68, tag: 'Ulrich: Work Practices' },
        { id: 'skill-badges',            name: 'Skill Badges & Leaderboards',    icon: 'fa-medal',                  base: 60, tag: 'Ulrich: Talent Flow' },
        { id: 'cross-mentorship',        name: 'Cross-Mentorship Program',       icon: 'fa-people-arrows',          base: 76, tag: 'ISO: Span' },
        { id: 'reverse-mentoring',       name: 'Reverse Mentoring',              icon: 'fa-rotate',                 base: 73, tag: 'ISO: Trust' },
        { id: 'inter-team-feedback',     name: 'Inter-Team Feedback Sessions',   icon: 'fa-arrows-turn-to-dots',    base: 70, tag: 'Ulrich: Information' },
        { id: 'micro-skills',            name: 'Micro-Skills Curriculum',         icon: 'fa-graduation-cap',         base: 66, tag: 'ISO: Development' },
        { id: 'habit-tracker',           name: 'Leadership Habit Tracker',        icon: 'fa-calendar-check',         base: 59, tag: 'Ulrich: Accountability' }
    ];

    // ================================================================
    // PRESET PROFILES — Three leadership archetypes
    // ================================================================

    var PRESETS = {
        visionary: {
            label: 'The Visionary',
            desc: 'High strategic + narrative, moderate execution',
            values: {
                'cognitive-efficiency': 68, 'strategic-impact': 92, 'resilience-coefficient': 70,
                'empathy-index': 65, 'communication': 78, 'influence-dynamics': 85,
                'visionary-leadership': 95, 'neural-flow': 72, 'cognitive-elasticity': 74,
                'neural-adaptability': 66, 'narrative-intelligence': 88, 'leadership-storytelling': 90,
                'shadowing': 55, 'okrs': 60, 'team-sentiment': 62, 'leadership-challenge': 58,
                'leadership-simulation': 64, 'skill-badges': 50, 'cross-mentorship': 65,
                'reverse-mentoring': 60, 'inter-team-feedback': 58, 'micro-skills': 55, 'habit-tracker': 52
            }
        },
        executor: {
            label: 'The Executor',
            desc: 'High operational + accountability, moderate vision',
            values: {
                'cognitive-efficiency': 85, 'strategic-impact': 70, 'resilience-coefficient': 82,
                'empathy-index': 60, 'communication': 88, 'influence-dynamics': 68,
                'visionary-leadership': 62, 'neural-flow': 55, 'cognitive-elasticity': 58,
                'neural-adaptability': 78, 'narrative-intelligence': 55, 'leadership-storytelling': 50,
                'shadowing': 80, 'okrs': 92, 'team-sentiment': 72, 'leadership-challenge': 85,
                'leadership-simulation': 82, 'skill-badges': 88, 'cross-mentorship': 75,
                'reverse-mentoring': 70, 'inter-team-feedback': 85, 'micro-skills': 90, 'habit-tracker': 95
            }
        },
        connector: {
            label: 'The Connector',
            desc: 'High empathy + trust + mentorship, moderate cognitive',
            values: {
                'cognitive-efficiency': 62, 'strategic-impact': 65, 'resilience-coefficient': 75,
                'empathy-index': 95, 'communication': 90, 'influence-dynamics': 80,
                'visionary-leadership': 68, 'neural-flow': 60, 'cognitive-elasticity': 58,
                'neural-adaptability': 72, 'narrative-intelligence': 78, 'leadership-storytelling': 82,
                'shadowing': 75, 'okrs': 65, 'team-sentiment': 92, 'leadership-challenge': 70,
                'leadership-simulation': 68, 'skill-badges': 72, 'cross-mentorship': 95,
                'reverse-mentoring': 90, 'inter-team-feedback': 88, 'micro-skills': 75, 'habit-tracker': 70
            }
        }
    };

    // ================================================================
    // STORAGE HELPERS
    // ================================================================

    var STORAGE_KEY = 'bsi-leadership-capital';

    function loadState() {
        try {
            var raw = localStorage.getItem(STORAGE_KEY);
            return raw ? JSON.parse(raw) : {};
        } catch (e) { return {}; }
    }

    function saveState(state) {
        try { localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); } catch (e) {}
    }

    function getVal(id) {
        var state = loadState();
        if (state[id] !== undefined) return state[id];
        var all = INDIVIDUAL_METRICS.concat(ORGANIZATIONAL_METRICS);
        for (var i = 0; i < all.length; i++) {
            if (all[i].id === id) return all[i].base;
        }
        return 50;
    }

    function setVal(id, val) {
        var v = Math.max(0, Math.min(100, parseInt(val, 10) || 0));
        var state = loadState();
        state[id] = v;
        saveState(state);
    }

    // ================================================================
    // SCORE INTERPRETATION
    // ================================================================

    function getInterpretation100(score) {
        if (score < 40) return { label: 'Developing', tier: 'developing' };
        if (score < 60) return { label: 'Emerging', tier: 'competent' };
        if (score < 80) return { label: 'Strong', tier: 'strong' };
        return { label: 'Elite', tier: 'elite' };
    }

    function getInterpretation10(score) {
        if (score < 3) return { label: 'Developing', tier: 'developing' };
        if (score < 6) return { label: 'Competent', tier: 'competent' };
        if (score < 8) return { label: 'Strong', tier: 'strong' };
        return { label: 'Elite', tier: 'elite' };
    }

    function updateInterpretation(elId, interp) {
        var el = document.getElementById(elId);
        if (!el) return;
        el.textContent = interp.label;
        el.className = 'kpi-interpretation tier-' + interp.tier;
    }

    // ================================================================
    // SCORE COLOR CODING
    // ================================================================

    function getScoreClass(val) {
        if (val < 40) return 'score-low';
        if (val < 70) return 'score-mid';
        return 'score-high';
    }

    // ================================================================
    // RENDER METRIC SLIDERS — Safe DOM construction, no innerHTML
    // ================================================================

    function renderMetrics(containerId, metrics) {
        var container = document.getElementById(containerId);
        // Clear existing children
        while (container.firstChild) {
            container.removeChild(container.firstChild);
        }

        metrics.forEach(function (metric) {
            var val = getVal(metric.id);

            // Row container
            var row = document.createElement('div');
            row.className = 'metric-item';

            // Left: metric info
            var infoDiv = document.createElement('div');
            infoDiv.className = 'metric-info';

            var iconWrap = document.createElement('div');
            iconWrap.className = 'metric-icon';
            var icon = document.createElement('i');
            icon.className = 'fas ' + metric.icon;
            iconWrap.appendChild(icon);

            var nameSpan = document.createElement('span');
            nameSpan.className = 'metric-name';
            nameSpan.textContent = metric.name;

            var tagSpan = document.createElement('span');
            tagSpan.className = 'framework-tag';
            tagSpan.textContent = metric.tag;

            infoDiv.appendChild(iconWrap);
            infoDiv.appendChild(nameSpan);
            infoDiv.appendChild(tagSpan);

            // Right: slider + score badge
            var sliderDiv = document.createElement('div');
            sliderDiv.className = 'slider-group';

            var slider = document.createElement('input');
            slider.type = 'range';
            slider.min = '0';
            slider.max = '100';
            slider.value = String(val);
            slider.setAttribute('data-metric-id', metric.id);
            slider.setAttribute('aria-label', metric.name);

            var badge = document.createElement('span');
            badge.className = 'score-badge ' + getScoreClass(val);
            badge.setAttribute('data-score-id', metric.id);
            badge.textContent = String(val);

            slider.addEventListener('input', (function (badgeRef, metricId) {
                return function () {
                    var v = parseInt(this.value, 10);
                    badgeRef.textContent = String(v);
                    badgeRef.className = 'score-badge ' + getScoreClass(v);
                    setVal(metricId, v);
                    recalculate();
                };
            })(badge, metric.id));

            sliderDiv.appendChild(slider);
            sliderDiv.appendChild(badge);

            row.appendChild(infoDiv);
            row.appendChild(sliderDiv);
            container.appendChild(row);
        });
    }

    // ================================================================
    // SCORING ALGORITHMS
    // ================================================================

    function avg() {
        var ids = Array.prototype.slice.call(arguments);
        var sum = 0;
        for (var i = 0; i < ids.length; i++) {
            sum += getVal(ids[i]);
        }
        return sum / ids.length;
    }

    // Geometric mean — penalizes weak-link pillars
    // If one pillar is 20 while others are 80, gmean ≈ 52 vs arithmetic mean 65
    function gmean(values) {
        var eps = 0.001;
        var logSum = 0;
        for (var i = 0; i < values.length; i++) {
            logSum += Math.log(Math.max(eps, values[i]));
        }
        return Math.exp(logSum / values.length);
    }

    // Standard deviation of an array of numbers
    function stddev(values) {
        if (values.length < 2) return 0;
        var m = 0;
        for (var i = 0; i < values.length; i++) m += values[i];
        m /= values.length;
        var variance = 0;
        for (var j = 0; j < values.length; j++) {
            variance += (values[j] - m) * (values[j] - m);
        }
        return Math.sqrt(variance / values.length);
    }

    function computeUlrich() {
        // 5 Individual factors — research crosswalk (many-to-many mapping)
        var personal  = avg('cognitive-efficiency', 'resilience-coefficient', 'neural-flow', 'cognitive-elasticity', 'neural-adaptability');
        var strategic = avg('strategic-impact', 'visionary-leadership', 'narrative-intelligence');
        var execution = avg('communication', 'influence-dynamics', 'okrs', 'habit-tracker');
        var people    = avg('empathy-index', 'team-sentiment', 'cross-mentorship', 'reverse-mentoring', 'inter-team-feedback', 'micro-skills');
        var brand     = avg('leadership-storytelling', 'visionary-leadership', 'narrative-intelligence');

        // 5 Organizational factors — research crosswalk
        var culture        = avg('team-sentiment', 'leadership-storytelling', 'leadership-challenge', 'inter-team-feedback');
        var talentFlow     = avg('cross-mentorship', 'reverse-mentoring', 'micro-skills', 'leadership-simulation', 'skill-badges');
        var accountability = avg('okrs', 'habit-tracker', 'inter-team-feedback');
        var information    = avg('narrative-intelligence', 'shadowing', 'team-sentiment');
        var workPractices  = avg('leadership-simulation', 'leadership-challenge', 'cognitive-elasticity', 'neural-adaptability');

        var indAvg = (personal + strategic + execution + people + brand) / 5;
        var orgAvg = (culture + talentFlow + accountability + information + workPractices) / 5;

        var lci = indAvg * 0.5 + orgAvg * 0.5;

        return {
            lci: Math.round(lci * 10) / 10,
            factors: {
                personal: Math.round(personal * 10) / 10,
                strategic: Math.round(strategic * 10) / 10,
                execution: Math.round(execution * 10) / 10,
                people: Math.round(people * 10) / 10,
                brand: Math.round(brand * 10) / 10,
                culture: Math.round(culture * 10) / 10,
                talentFlow: Math.round(talentFlow * 10) / 10,
                accountability: Math.round(accountability * 10) / 10,
                information: Math.round(information * 10) / 10,
                workPractices: Math.round(workPractices * 10) / 10
            }
        };
    }

    function computeISO() {
        // ISO/TS 30431 trust pillar — core trust-building metrics
        var trust = avg('empathy-index', 'communication', 'team-sentiment', 'inter-team-feedback');
        // ISO/TS 30431 leadership development pillar — growth and capability building
        var dev = avg('micro-skills', 'leadership-simulation', 'cross-mentorship',
                      'reverse-mentoring', 'skill-badges', 'habit-tracker', 'shadowing');
        // Span of control — organizational reach proxy
        var span = avg('cross-mentorship', 'influence-dynamics', 'okrs');

        var score = trust * 0.4 + dev * 0.4 + span * 0.2;
        return {
            score: Math.round(score * 10) / 10,
            trust: Math.round(trust * 10) / 10,
            dev: Math.round(dev * 10) / 10
        };
    }

    function computeMLQ() {
        var iia = avg('visionary-leadership', 'resilience-coefficient');
        var iib = avg('influence-dynamics', 'leadership-storytelling');
        var im  = avg('strategic-impact', 'communication', 'narrative-intelligence');
        var is_ = avg('cognitive-efficiency', 'neural-flow', 'cognitive-elasticity');
        var ic  = avg('empathy-index', 'cross-mentorship', 'reverse-mentoring');

        var score = (iia + iib + im + is_ + ic) / 5;
        return {
            score: Math.round(score * 10) / 10,
            factors: {
                iia: Math.round(iia * 10) / 10,
                iib: Math.round(iib * 10) / 10,
                im: Math.round(im * 10) / 10,
                is: Math.round(is_ * 10) / 10,
                ic: Math.round(ic * 10) / 10
            }
        };
    }

    // --- THE "IT" FACTOR --- Synergy + Coherence + Trust Cap
    // Based on latent construct methodology: geometric mean penalizes
    // weak-link pillars, coherence rewards consistency, trust cap
    // prevents "charisma without trust" scoring inflation.
    function computeItFactor() {
        // 4 research-backed pillars (0-100 each)
        var adaptability = avg('cognitive-efficiency', 'neural-flow', 'cognitive-elasticity',
                              'neural-adaptability', 'resilience-coefficient');
        var trustInfluence = avg('empathy-index', 'communication', 'influence-dynamics',
                                'team-sentiment');
        var meaningNarrative = avg('visionary-leadership', 'narrative-intelligence',
                                  'leadership-storytelling');
        var executionAlignment = avg('strategic-impact', 'okrs', 'habit-tracker');

        var pillars = [adaptability, trustInfluence, meaningNarrative, executionAlignment];

        // Synergy: geometric mean (weak-link penalization)
        var synergy = gmean(pillars);

        // Coherence: inverse of dispersion (consistency bonus)
        // 1.35 scaling factor chosen so 1 std dev of ~25 points gives meaningful penalty
        var dispersion = stddev(pillars);
        var coherence = Math.max(0, Math.min(100, 100 - (dispersion * 1.35)));

        // Trust-aware cap: charisma without trust is manipulation
        // Uses ISO trust proxy metrics directly
        var isoTrust = avg('empathy-index', 'communication', 'team-sentiment', 'inter-team-feedback');
        var trustCap = isoTrust < 45 ? 6.0 : (isoTrust < 60 ? 8.0 : 10.0);

        // Composite: 70% synergy + 30% coherence, scaled to 0-10, capped by trust
        var raw = 10 * ((0.7 * synergy + 0.3 * coherence) / 100);
        var it = Math.min(raw, trustCap);

        return {
            score: Math.round(it * 10) / 10,
            pillars: {
                adaptability: Math.round(adaptability * 10) / 10,
                trustInfluence: Math.round(trustInfluence * 10) / 10,
                meaningNarrative: Math.round(meaningNarrative * 10) / 10,
                executionAlignment: Math.round(executionAlignment * 10) / 10
            },
            synergy: Math.round(synergy * 10) / 10,
            coherence: Math.round(coherence * 10) / 10,
            trustCap: trustCap
        };
    }

    // ================================================================
    // CHART.JS CONFIGURATION
    // ================================================================

    var chartColors = {
        fill: 'rgba(191, 87, 0, 0.15)',
        border: '#BF5700',
        point: '#FF6B35',
        pointBorder: '#FAFAFA',
        grid: 'rgba(255, 255, 255, 0.06)',
        label: '#a3a3a3',
        tick: '#737373'
    };

    var commonRadarOpts = {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
            legend: { display: false }
        },
        scales: {
            r: {
                min: 0,
                max: 100,
                ticks: {
                    stepSize: 20,
                    color: chartColors.tick,
                    backdropColor: 'transparent',
                    font: { family: "'JetBrains Mono'", size: 10 }
                },
                pointLabels: {
                    color: chartColors.label,
                    font: { family: "'Inter'", size: 11, weight: 500 }
                },
                grid: { color: chartColors.grid },
                angleLines: { color: chartColors.grid }
            }
        }
    };

    var ulrichChart = null;
    var mlqChart = null;
    var itBarChart = null;

    function initCharts() {
        var ulrichCtx = document.getElementById('radarUlrich').getContext('2d');
        ulrichChart = new Chart(ulrichCtx, {
            type: 'radar',
            data: {
                labels: [
                    'Personal Prof.', 'Strategic Prof.', 'Execution Prof.',
                    'People Prof.', 'Leadership Brand',
                    'Culture Cap.', 'Talent Flow', 'Performance Acc.',
                    'Information', 'Work Practices'
                ],
                datasets: [{
                    label: 'Ulrich LCI',
                    data: [50, 50, 50, 50, 50, 50, 50, 50, 50, 50],
                    backgroundColor: chartColors.fill,
                    borderColor: chartColors.border,
                    borderWidth: 2,
                    pointBackgroundColor: chartColors.point,
                    pointBorderColor: chartColors.pointBorder,
                    pointBorderWidth: 1,
                    pointRadius: 4
                }]
            },
            options: commonRadarOpts
        });

        var mlqCtx = document.getElementById('radarMLQ').getContext('2d');
        mlqChart = new Chart(mlqCtx, {
            type: 'radar',
            data: {
                labels: [
                    'Idealized Infl. (A)',
                    'Idealized Infl. (B)',
                    'Inspirational Motivation',
                    'Intellectual Stimulation',
                    'Individualized Consid.'
                ],
                datasets: [{
                    label: 'MLQ 5X Transformational',
                    data: [50, 50, 50, 50, 50],
                    backgroundColor: 'rgba(253, 185, 19, 0.12)',
                    borderColor: '#FDB913',
                    borderWidth: 2,
                    pointBackgroundColor: '#FDB913',
                    pointBorderColor: chartColors.pointBorder,
                    pointBorderWidth: 1,
                    pointRadius: 4
                }]
            },
            options: commonRadarOpts
        });

        // --- It Factor Cluster Bar Chart ---
        var barCtx = document.getElementById('barItClusters').getContext('2d');
        itBarChart = new Chart(barCtx, {
            type: 'bar',
            data: {
                labels: ['Adaptability/Focus', 'Trust/Influence', 'Meaning/Narrative', 'Execution/Alignment'],
                datasets: [{
                    label: 'Cluster Score',
                    data: [50, 50, 50, 50],
                    backgroundColor: [
                        'rgba(191, 87, 0, 0.6)',
                        'rgba(253, 185, 19, 0.6)',
                        'rgba(255, 107, 53, 0.6)',
                        'rgba(139, 69, 19, 0.6)'
                    ],
                    borderColor: [
                        '#BF5700',
                        '#FDB913',
                        '#FF6B35',
                        '#8B4513'
                    ],
                    borderWidth: 1,
                    borderRadius: 6
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: { display: false }
                },
                scales: {
                    x: {
                        min: 0,
                        max: 100,
                        ticks: {
                            color: chartColors.tick,
                            font: { family: "'JetBrains Mono'", size: 10 }
                        },
                        grid: { color: chartColors.grid }
                    },
                    y: {
                        ticks: {
                            color: chartColors.label,
                            font: { family: "'Inter'", size: 12, weight: 500 }
                        },
                        grid: { display: false }
                    }
                }
            }
        });
    }

    function updateCharts(ulrichFactors, mlqFactors) {
        if (ulrichChart) {
            ulrichChart.data.datasets[0].data = [
                ulrichFactors.personal, ulrichFactors.strategic, ulrichFactors.execution,
                ulrichFactors.people, ulrichFactors.brand,
                ulrichFactors.culture, ulrichFactors.talentFlow, ulrichFactors.accountability,
                ulrichFactors.information, ulrichFactors.workPractices
            ];
            ulrichChart.update('none');
        }

        if (mlqChart) {
            mlqChart.data.datasets[0].data = [
                mlqFactors.iia, mlqFactors.iib, mlqFactors.im, mlqFactors.is, mlqFactors.ic
            ];
            mlqChart.update('none');
        }
    }

    // ================================================================
    // RECALCULATE — ties everything together
    // ================================================================

    function recalculate() {
        var ulrich = computeUlrich();
        var iso = computeISO();         // now returns { score, trust, dev }
        var mlq = computeMLQ();
        var itResult = computeItFactor(); // now returns { score, pillars, synergy, coherence, trustCap }

        // Update KPI numbers using safe textContent
        document.getElementById('kpi-ulrich').textContent = String(ulrich.lci);
        document.getElementById('kpi-iso').textContent = String(iso.score);
        document.getElementById('kpi-mlq').textContent = String(mlq.score);

        // It Factor: build number + unit span safely
        var itEl = document.getElementById('kpi-it');
        while (itEl.firstChild) itEl.removeChild(itEl.firstChild);
        itEl.appendChild(document.createTextNode(String(itResult.score)));
        var unitSpan = document.createElement('span');
        unitSpan.className = 'kpi-unit';
        unitSpan.textContent = '/10';
        itEl.appendChild(unitSpan);

        // Update interpretation labels
        updateInterpretation('interp-ulrich', getInterpretation100(ulrich.lci));
        updateInterpretation('interp-iso', getInterpretation100(iso.score));
        updateInterpretation('interp-mlq', getInterpretation100(mlq.score));
        updateInterpretation('interp-it', getInterpretation10(itResult.score));

        // Update synergy/coherence/trust-cap breakdown display
        var compositionEl = document.getElementById('it-composition');
        if (compositionEl) {
            compositionEl.textContent = 'Syn=' + itResult.synergy +
                ' \u00B7 Coh=' + itResult.coherence +
                ' \u00B7 Cap=' + itResult.trustCap.toFixed(1);
        }

        // Update radar charts
        updateCharts(ulrich.factors, mlq.factors);

        // Update bar chart — 4 research-backed pillars
        if (itBarChart) {
            itBarChart.data.datasets[0].data = [
                itResult.pillars.adaptability,
                itResult.pillars.trustInfluence,
                itResult.pillars.meaningNarrative,
                itResult.pillars.executionAlignment
            ];
            itBarChart.update('none');
        }
    }

    // ================================================================
    // RESET — clear localStorage and restore defaults
    // ================================================================

    function resetAll() {
        localStorage.removeItem(STORAGE_KEY);
        renderMetrics('individual-metrics', INDIVIDUAL_METRICS);
        renderMetrics('organizational-metrics', ORGANIZATIONAL_METRICS);
        recalculate();
    }

    // ================================================================
    // METHODOLOGY TOGGLE
    // ================================================================

    function initMethodologyToggle() {
        var toggle = document.getElementById('methodToggle');
        var content = document.getElementById('methodContent');

        toggle.addEventListener('click', function () {
            var isOpen = content.classList.toggle('open');
            toggle.setAttribute('aria-expanded', String(isOpen));
        });
    }

    // ================================================================
    // PRESET APPLICATION
    // ================================================================

    function applyPreset(presetKey) {
        var preset = PRESETS[presetKey];
        if (!preset) return;

        // Save all preset values
        var state = {};
        var keys = Object.keys(preset.values);
        for (var i = 0; i < keys.length; i++) {
            state[keys[i]] = preset.values[keys[i]];
        }
        saveState(state);

        // Re-render sliders with new values
        renderMetrics('individual-metrics', INDIVIDUAL_METRICS);
        renderMetrics('organizational-metrics', ORGANIZATIONAL_METRICS);
        recalculate();

        // Update active button state
        var btns = document.querySelectorAll('.preset-btn');
        for (var j = 0; j < btns.length; j++) {
            btns[j].classList.toggle('active', btns[j].getAttribute('data-preset') === presetKey);
        }
    }

    // ================================================================
    // EXPORT / IMPORT
    // ================================================================

    function exportConfig() {
        var state = loadState();
        var all = INDIVIDUAL_METRICS.concat(ORGANIZATIONAL_METRICS);
        var config = { version: 1, tool: 'bsi-leadership-capital', metrics: {} };
        for (var i = 0; i < all.length; i++) {
            config.metrics[all[i].id] = state[all[i].id] !== undefined ? state[all[i].id] : all[i].base;
        }
        var blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
        var url = URL.createObjectURL(blob);
        var a = document.createElement('a');
        a.href = url;
        a.download = 'leadership-capital-config.json';
        a.click();
        URL.revokeObjectURL(url);
    }

    function importConfig(file) {
        var reader = new FileReader();
        reader.onload = function (e) {
            try {
                var config = JSON.parse(e.target.result);
                if (!config.metrics || typeof config.metrics !== 'object') return;
                var state = {};
                var keys = Object.keys(config.metrics);
                for (var i = 0; i < keys.length; i++) {
                    var v = parseInt(config.metrics[keys[i]], 10);
                    if (!isNaN(v)) state[keys[i]] = Math.max(0, Math.min(100, v));
                }
                saveState(state);
                renderMetrics('individual-metrics', INDIVIDUAL_METRICS);
                renderMetrics('organizational-metrics', ORGANIZATIONAL_METRICS);
                recalculate();
                // Clear active preset
                var btns = document.querySelectorAll('.preset-btn');
                for (var j = 0; j < btns.length; j++) btns[j].classList.remove('active');
            } catch (err) {
                // Invalid JSON — silently ignore
            }
        };
        reader.readAsText(file);
    }

    // ================================================================
    // INIT
    // ================================================================

    function init() {
        renderMetrics('individual-metrics', INDIVIDUAL_METRICS);
        renderMetrics('organizational-metrics', ORGANIZATIONAL_METRICS);
        initCharts();
        recalculate();
        initMethodologyToggle();

        document.getElementById('recalcBtn').addEventListener('click', recalculate);
        document.getElementById('resetBtn').addEventListener('click', resetAll);

        // Preset buttons
        var presetBtns = document.querySelectorAll('.preset-btn');
        for (var i = 0; i < presetBtns.length; i++) {
            presetBtns[i].addEventListener('click', (function (btn) {
                return function () { applyPreset(btn.getAttribute('data-preset')); };
            })(presetBtns[i]));
        }

        // Export/Import
        document.getElementById('exportBtn').addEventListener('click', exportConfig);
        var importFileEl = document.getElementById('importFile');
        document.getElementById('importBtn').addEventListener('click', function () {
            importFileEl.click();
        });
        importFileEl.addEventListener('change', function () {
            if (this.files && this.files[0]) {
                importConfig(this.files[0]);
                this.value = '';
            }
        });
    }

    // Wait for DOM
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
    } else {
        init();
    }
})();
</script>
</body>
</html>
