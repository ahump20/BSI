<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Michigan Wolverines - Advanced Analytics | Blaze Sports Intel</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="/css/bsi-tokens.css">
  <style>
        :root { --team-primary: #00274C; --team-secondary: #FFCB05; --bg-dark: #0d0d0d; --bg-card: #1a1a1a; --text-primary: #ffffff; --text-secondary: #a0a0a0; --success: #22c55e; --danger: #ef4444; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-dark); color: var(--text-primary); min-height: 100vh; padding: 1rem; }
        .header { background: linear-gradient(135deg, var(--team-primary) 0%, #001529 50%, var(--team-secondary) 100%); border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 1rem; }
        .team-info { display: flex; align-items: center; gap: 1rem; }
        .team-logo { width: 64px; height: 64px; border-radius: 8px; background: rgba(255,255,255,0.1); }
        .team-name { font-size: 1.75rem; font-weight: 700; }
        .team-record { font-size: 1rem; color: rgba(255,255,255,0.8); margin-top: 0.25rem; }
        .header-stats { display: flex; gap: 1.5rem; flex-wrap: wrap; }
        .header-stat { text-align: center; }
        .header-stat-value { font-size: 1.5rem; font-weight: 700; }
        .header-stat-label { font-size: 0.75rem; color: rgba(255,255,255,0.7); text-transform: uppercase; }
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 1rem; }
        .card { background: var(--bg-card); border-radius: 12px; padding: 1.25rem; border: 1px solid rgba(255,255,255,0.05); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .card-title { font-size: 1rem; font-weight: 600; }
        .card-badge { font-size: 0.7rem; padding: 0.25rem 0.5rem; border-radius: 4px; background: var(--team-secondary); color: var(--team-primary); font-weight: 600; }
        .standings-table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        .standings-table th { text-align: left; padding: 0.5rem; color: var(--text-secondary); font-weight: 500; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .standings-table td { padding: 0.5rem; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .standings-table tr.current-team { background: rgba(0,39,76,0.3); }
        .stat-row { display: flex; justify-content: space-between; align-items: center; padding: 0.6rem 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .stat-row:last-child { border-bottom: none; }
        .stat-label { color: var(--text-secondary); font-size: 0.85rem; }
        .stat-value { font-weight: 600; font-size: 0.95rem; }
        .stat-value.positive { color: var(--success); }
        .stat-value.negative { color: var(--danger); }
        .schedule-item { display: flex; justify-content: space-between; align-items: center; padding: 0.6rem 0; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 0.85rem; }
        .schedule-item:last-child { border-bottom: none; }
        .schedule-opponent { display: flex; align-items: center; gap: 0.5rem; }
        .schedule-result { font-weight: 600; }
        .schedule-result.win { color: var(--success); }
        .schedule-result.loss { color: var(--danger); }
        .schedule-result.upcoming { color: var(--text-secondary); }
        .home-indicator { font-size: 0.7rem; color: var(--text-secondary); }
        .rank-badge { font-size: 0.7rem; padding: 0.15rem 0.4rem; border-radius: 3px; background: var(--team-secondary); color: var(--team-primary); font-weight: 600; margin-left: 0.25rem; }
        .pythagorean-display { text-align: center; padding: 1.5rem; }
        .pyth-value { font-size: 3rem; font-weight: 700; color: var(--team-secondary); }
        .pyth-label { color: var(--text-secondary); margin-top: 0.5rem; }
        .pyth-expected { font-size: 1.25rem; margin-top: 1rem; }
        .efficiency-bar { height: 8px; background: rgba(255,255,255,0.1); border-radius: 4px; overflow: hidden; margin-top: 0.5rem; }
        .efficiency-fill { height: 100%; border-radius: 4px; background: linear-gradient(90deg, var(--team-primary), var(--team-secondary)); }
        .efficiency-item { margin-bottom: 1rem; }
        .efficiency-header { display: flex; justify-content: space-between; font-size: 0.85rem; }
        .efficiency-label { color: var(--text-secondary); }
        .efficiency-value { font-weight: 600; }
        .loading { text-align: center; padding: 2rem; color: var(--text-secondary); }
        .last-updated { text-align: center; padding: 1rem; color: var(--text-secondary); font-size: 0.75rem; }
        @media (max-width: 768px) { .header { flex-direction: column; text-align: center; } .header-stats { justify-content: center; } .dashboard-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="header">
        <div class="team-info"><img id="teamLogo" class="team-logo" src="" alt="Michigan"><div><div class="team-name">Michigan Wolverines</div><div class="team-record" id="teamRecord">Loading...</div></div></div>
        <div class="header-stats">
            <div class="header-stat"><div class="header-stat-value" id="confRecord">-</div><div class="header-stat-label">Big Ten Record</div></div>
            <div class="header-stat"><div class="header-stat-value" id="winPct">-</div><div class="header-stat-label">Win %</div></div>
            <div class="header-stat"><div class="header-stat-value" id="apRank">-</div><div class="header-stat-label">AP Rank</div></div>
            <div class="header-stat"><div class="header-stat-value" id="homeRecord">-</div><div class="header-stat-label">Home</div></div>
            <div class="header-stat"><div class="header-stat-value" id="awayRecord">-</div><div class="header-stat-label">Away</div></div>
        </div>
    </div>
    <div class="dashboard-grid">
        <div class="card"><div class="card-header"><span class="card-title">Big Ten Standings</span><span class="card-badge">CONFERENCE</span></div><div id="standingsContent" class="loading">Loading...</div></div>
        <div class="card"><div class="card-header"><span class="card-title">Pythagorean Win Expectancy</span><span class="card-badge">ANALYTICS</span></div><div class="pythagorean-display"><div class="pyth-value" id="pythWinPct">-</div><div class="pyth-label">Expected Win %</div><div class="pyth-expected" id="pythRecord">Calculating...</div></div></div>
        <div class="card"><div class="card-header"><span class="card-title">Offensive Performance</span><span class="card-badge">OFFENSE</span></div><div id="offenseContent" class="loading">Loading...</div></div>
        <div class="card"><div class="card-header"><span class="card-title">Defensive Performance</span><span class="card-badge">DEFENSE</span></div><div id="defenseContent" class="loading">Loading...</div></div>
        <div class="card" style="grid-column: span 2;"><div class="card-header"><span class="card-title">2025 Schedule & Results</span><span class="card-badge">SCHEDULE</span></div><div id="scheduleContent" class="loading">Loading...</div></div>
        <div class="card"><div class="card-header"><span class="card-title">Scoring Analysis</span><span class="card-badge">POINTS</span></div><div id="scoringContent" class="loading">Loading...</div></div>
        <div class="card"><div class="card-header"><span class="card-title">Efficiency Metrics</span><span class="card-badge">ADVANCED</span></div><div id="efficiencyContent" class="loading">Loading...</div></div>
    </div>
    <div class="last-updated">Data provided by ESPN API | Last updated: <span id="lastUpdated">-</span></div>
    <script>
        const ESPN_BASE='https://site.api.espn.com/apis/site/v2/sports/football/college-football',ESPN_V2='https://site.api.espn.com/apis/v2/sports/football/college-football',TEAM_ID='130',CONF_GROUP='5',CFB_PYTHAGOREAN_EXP=2.37;let teamStats={pointsFor:0,pointsAgainst:0,wins:0,losses:0,gamesPlayed:0};
        async function fetchTeamData(){try{const r=await fetch(`${ESPN_BASE}/teams/${TEAM_ID}`),d=await r.json(),t=d.team;document.getElementById('teamLogo').src=t.logos?.[0]?.href||'';const rec=t.record?.items?.[0];if(rec){document.getElementById('teamRecord').textContent=`${rec.summary||'0-0'} Overall`;const s=rec.stats||[];teamStats.wins=s.find(x=>x.name==='wins')?.value||0;teamStats.losses=s.find(x=>x.name==='losses')?.value||0;teamStats.gamesPlayed=teamStats.wins+teamStats.losses;document.getElementById('winPct').textContent=((s.find(x=>x.name==='winPercent')?.value||0)*100).toFixed(1)+'%';}document.getElementById('confRecord').textContent=t.record?.items?.find(r=>r.type==='vsconf')?.summary||'-';document.getElementById('homeRecord').textContent=t.record?.items?.find(r=>r.type==='home')?.summary||'-';document.getElementById('awayRecord').textContent=t.record?.items?.find(r=>r.type==='road')?.summary||'-';document.getElementById('apRank').textContent=t.rank?`#${t.rank}`:'NR';}catch(e){console.error(e);}}
        async function fetchStandings(){try{const r=await fetch(`${ESPN_V2}/standings?group=${CONF_GROUP}`),d=await r.json();let html='<table class="standings-table"><thead><tr><th>Team</th><th>Conf</th><th>Overall</th><th>PF</th><th>PA</th></tr></thead><tbody>';d.standings?.entries?.forEach(e=>{const n=e.team?.shortDisplayName||'Unknown',id=e.team?.id;let cr='-',ov='-',pf=0,pa=0;e.stats?.forEach(s=>{if(s.name==='vsconf_wins'){cr=`${e.stats.find(x=>x.name==='vsconf_wins')?.value||0}-${e.stats.find(x=>x.name==='vsconf_losses')?.value||0}`;}if(s.name==='overall')ov=s.displayValue||'-';if(s.name==='pointsFor')pf=s.value||0;if(s.name==='pointsAgainst')pa=s.value||0;});const isCur=id===TEAM_ID;if(isCur){teamStats.pointsFor=pf;teamStats.pointsAgainst=pa;}html+=`<tr class="${isCur?'current-team':''}"><td>${n}</td><td>${cr}</td><td>${ov}</td><td>${pf}</td><td>${pa}</td></tr>`;});html+='</tbody></table>';document.getElementById('standingsContent').innerHTML=html;calculatePythagorean();}catch(e){document.getElementById('standingsContent').innerHTML='<p>Unable to load</p>';}}
        function calculatePythagorean(){if(teamStats.pointsFor>0&&teamStats.pointsAgainst>0){const pf=Math.pow(teamStats.pointsFor,CFB_PYTHAGOREAN_EXP),pa=Math.pow(teamStats.pointsAgainst,CFB_PYTHAGOREAN_EXP),pct=pf/(pf+pa);document.getElementById('pythWinPct').textContent=(pct*100).toFixed(1)+'%';document.getElementById('pythRecord').textContent=`Expected: ${(pct*teamStats.gamesPlayed).toFixed(1)}-${((1-pct)*teamStats.gamesPlayed).toFixed(1)} (Actual: ${teamStats.wins}-${teamStats.losses})`;}else{document.getElementById('pythWinPct').textContent='-';document.getElementById('pythRecord').textContent='Insufficient data';}}
        async function fetchSchedule(){try{const r=await fetch(`${ESPN_BASE}/teams/${TEAM_ID}/schedule`),d=await r.json();let html='<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:0.5rem;">';(d.events||[]).forEach(ev=>{const c=ev.competitions?.[0],isH=c?.competitors?.find(x=>x.id===TEAM_ID)?.homeAway==='home',opp=c?.competitors?.find(x=>x.id!==TEAM_ID),tc=c?.competitors?.find(x=>x.id===TEAM_ID),on=opp?.team?.shortDisplayName||'TBD',or=opp?.curatedRank?.current<=25?`<span class="rank-badge">#${opp.curatedRank.current}</span>`:'';let res='',rc='upcoming';if(c?.status?.type?.completed){const ts=tc?.score?.value||tc?.score||0,os=opp?.score?.value||opp?.score||0,w=parseFloat(ts)>parseFloat(os);res=`${w?'W':'L'} ${ts}-${os}`;rc=w?'win':'loss';}else if(c?.status?.type?.state==='in'){res=`LIVE ${tc?.score||0}-${opp?.score||0}`;}else{res=new Date(ev.date).toLocaleDateString('en-US',{month:'short',day:'numeric'});}html+=`<div class="schedule-item"><div class="schedule-opponent"><span class="home-indicator">${isH?'vs':'@'}</span><span>${on}</span>${or}</div><div class="schedule-result ${rc}">${res}</div></div>`;});html+='</div>';document.getElementById('scheduleContent').innerHTML=html||'<p>No schedule</p>';}catch(e){document.getElementById('scheduleContent').innerHTML='<p>Unable to load</p>';}}
        async function fetchTeamStats(){try{const r=await fetch(`${ESPN_BASE}/teams/${TEAM_ID}/statistics`),d=await r.json(),stats=d.statistics||[],find=(n)=>{for(const c of stats){const f=c.stats?.find(s=>s.name===n);if(f)return f;}return null;},off=[{k:'totalYards',l:'Total Yards'},{k:'yardsPerGame',l:'Yards/Game'},{k:'passingYards',l:'Passing Yards'},{k:'rushingYards',l:'Rushing Yards'},{k:'yardsPerPlay',l:'Yards/Play'}],def=[{k:'opponentTotalYards',l:'Yards Allowed'},{k:'opponentYardsPerGame',l:'Opp Yards/Game'},{k:'sacks',l:'Sacks'},{k:'interceptions',l:'INTs'},{k:'fumblesRecovered',l:'Fumbles Rec'}];let oh='',dh='';off.forEach(s=>{const f=find(s.k);oh+=`<div class="stat-row"><span class="stat-label">${s.l}</span><span class="stat-value">${f?.displayValue||f?.value||'-'}</span></div>`;});def.forEach(s=>{const f=find(s.k);dh+=`<div class="stat-row"><span class="stat-label">${s.l}</span><span class="stat-value">${f?.displayValue||f?.value||'-'}</span></div>`;});document.getElementById('offenseContent').innerHTML=oh||'<p>No stats</p>';document.getElementById('defenseContent').innerHTML=dh||'<p>No stats</p>';const ppg=find('pointsPerGame'),oppPpg=find('opponentPointsPerGame'),diff=teamStats.pointsFor-teamStats.pointsAgainst;document.getElementById('scoringContent').innerHTML=`<div class="stat-row"><span class="stat-label">Points/Game</span><span class="stat-value">${ppg?.displayValue||'-'}</span></div><div class="stat-row"><span class="stat-label">Opp Points/Game</span><span class="stat-value">${oppPpg?.displayValue||'-'}</span></div><div class="stat-row"><span class="stat-label">Point Diff</span><span class="stat-value ${diff>0?'positive':'negative'}">${diff>0?'+':''}${diff}</span></div><div class="stat-row"><span class="stat-label">Total Points</span><span class="stat-value">${teamStats.pointsFor||'-'}</span></div>`;const td=find('thirdDownConvPct'),rz=find('redZonePct'),to=find('turnoverMargin'),top=find('avgTimeOfPossession');let eh='';if(td){const p=parseFloat(td.value)||0;eh+=`<div class="efficiency-item"><div class="efficiency-header"><span class="efficiency-label">3rd Down %</span><span class="efficiency-value">${(p*100).toFixed(1)}%</span></div><div class="efficiency-bar"><div class="efficiency-fill" style="width:${p*100}%"></div></div></div>`;}if(rz){const p=parseFloat(rz.value)||0;eh+=`<div class="efficiency-item"><div class="efficiency-header"><span class="efficiency-label">Red Zone %</span><span class="efficiency-value">${(p*100).toFixed(1)}%</span></div><div class="efficiency-bar"><div class="efficiency-fill" style="width:${p*100}%"></div></div></div>`;}if(to){const m=parseFloat(to.value)||0;eh+=`<div class="efficiency-item"><div class="efficiency-header"><span class="efficiency-label">TO Margin</span><span class="efficiency-value ${m>0?'positive':m<0?'negative':''}">${m>0?'+':''}${m}</span></div><div class="efficiency-bar"><div class="efficiency-fill" style="width:${Math.min(100,Math.max(0,(m+20)/40*100))}%"></div></div></div>`;}if(top)eh+=`<div class="efficiency-item"><div class="efficiency-header"><span class="efficiency-label">Avg TOP</span><span class="efficiency-value">${top.displayValue||'-'}</span></div></div>`;document.getElementById('efficiencyContent').innerHTML=eh||'<p>No data</p>';}catch(e){document.getElementById('offenseContent').innerHTML='<p>Unable to load</p>';document.getElementById('defenseContent').innerHTML='<p>Unable to load</p>';}}
        async function init(){await Promise.all([fetchTeamData(),fetchStandings(),fetchSchedule(),fetchTeamStats()]);document.getElementById('lastUpdated').textContent=new Date().toLocaleString('en-US',{timeZone:'America/Chicago',dateStyle:'medium',timeStyle:'short'})+' CT';}init();setInterval(init,300000);
    </script>
</body>
</html>