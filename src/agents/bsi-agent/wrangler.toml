# BSI Portal Intelligence Agent - Cloudflare Worker Configuration
name = "bsi-portal-agent"
main = "dist/index.js"
compatibility_date = "2024-12-01"

# Build configuration
[build]
command = "npm run build"

# Environment variables (secrets added via `wrangler secret put`)
[vars]
ENVIRONMENT = "production"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "bsi-portal-db"
database_id = "d48fd89c-f2de-415b-935b-429f5e1fd60e"

# Scheduled triggers for polling
[triggers]
# During portal season (May-June): Every 10 minutes
# Off-season: Every 4 hours
# Adjust based on your needs and Twitter API budget
crons = ["*/10 * * 5-6 *", "0 */4 * 1-4,7-12 *"]

# Development settings
[dev]
port = 8787
local_protocol = "http"

# Preview environment
[env.preview]
name = "bsi-portal-agent-preview"
[env.preview.vars]
ENVIRONMENT = "preview"
