<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Live scores from MLB, NFL, NBA, College Baseball, and College Football. Real-time updates with odds, injuries, and highlights from Blaze Sports Intel.">
  <meta name="theme-color" content="#BF5700">
  <title>Live Scores | Blaze Sports Intel</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Oswald:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">

  <style>
    :root {
      --bsi-burnt-orange: #BF5700;
      --bsi-texas-soil: #8B4513;
      --bsi-charcoal: #1A1A1A;
      --bsi-midnight: #0D0D0D;
      --bsi-cream: #FAF8F5;
      --bsi-warm-white: #FAFAFA;
      --bsi-ember: #FF6B35;
      --bsi-gold: #C9A227;
      --bsi-success: #2E7D32;
      --bsi-warning: #F9A825;
      --bsi-live: #C62828;
      --bsi-info: #1976D2;
      --font-display: 'Oswald', 'Helvetica Neue', sans-serif;
      --font-body: 'Cormorant Garamond', Georgia, serif;
      --font-ui: 'Oswald', 'Helvetica Neue', sans-serif;
      --font-mono: 'IBM Plex Mono', monospace;
      --radius-sm: 6px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
      --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);
      --shadow-glow: 0 0 20px rgba(198, 40, 40, 0.3);
      --transition-fast: 150ms ease;
      --transition-normal: 250ms ease;
      --bg-primary: var(--bsi-midnight);
      --bg-secondary: var(--bsi-charcoal);
      --bg-card: #242424;
      --text-primary: var(--bsi-cream);
      --text-secondary: rgba(250, 248, 245, 0.7);
      --text-muted: rgba(250, 248, 245, 0.5);
      --border-color: rgba(255, 255, 255, 0.1);
      --border-hover: rgba(191, 87, 0, 0.5);
    }
    /* BSI Brand: Dark mode only */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-body);
      font-size: 1rem;
      line-height: 1.6;
      color: var(--text-primary);
      background: var(--bg-primary);
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
    }
    a { color: inherit; text-decoration: none; }
    button { font-family: inherit; cursor: pointer; border: none; background: none; }
    img { max-width: 100%; height: auto; }
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0; }
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      padding: 0.875rem 1.5rem;
      background: rgba(13, 13, 13, 0.95);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border-color);
    }
        .header-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }
    .logo {
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      background: linear-gradient(135deg, var(--bsi-burnt-orange), var(--bsi-ember));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      white-space: nowrap;
    }
    .header-controls { display: flex; align-items: center; gap: 1rem; }
    .nav { display: flex; gap: 1.5rem; align-items: center; }
    .nav a {
      font-family: var(--font-ui);
      font-size: 0.8rem;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      color: var(--text-secondary);
      transition: color var(--transition-fast);
      white-space: nowrap;
    }
    .nav a:hover, .nav a.active { color: var(--bsi-burnt-orange); }
    .theme-toggle {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      color: var(--text-secondary);
      transition: all var(--transition-fast);
    }
    .theme-toggle:hover { border-color: var(--bsi-burnt-orange); color: var(--bsi-burnt-orange); }
    .theme-toggle svg { width: 18px; height: 18px; }
    .mobile-menu-btn { display: none; width: 36px; height: 36px; align-items: center; justify-content: center; color: var(--text-primary); }
    .page-wrapper { display: flex; padding-top: 60px; min-height: 100vh; }
    .sidebar {
      width: 280px;
      flex-shrink: 0;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border-color);
      padding: 1.5rem 0;
      position: sticky;
      top: 60px;
      height: calc(100vh - 60px);
      overflow-y: auto;
    }
    .sidebar-section { padding: 0 1rem; margin-bottom: 1.5rem; }
    .sidebar-section h3 {
      font-family: var(--font-ui);
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-bottom: 0.75rem;
      padding: 0 0.5rem;
    }
    .injury-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.75rem;
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      margin-bottom: 0.5rem;
      border: 1px solid var(--border-color);
    }
    .injury-item:hover { border-color: var(--border-hover); }
    .injury-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--bg-secondary); object-fit: cover; }
    .injury-info { flex: 1; min-width: 0; }
    .injury-name { font-family: var(--font-ui); font-size: 0.8rem; font-weight: 600; color: var(--text-primary); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .injury-team { font-size: 0.7rem; color: var(--text-muted); }
    .injury-status { font-size: 0.65rem; font-weight: 600; padding: 0.15rem 0.4rem; border-radius: 3px; text-transform: uppercase; }
    .injury-status.out { background: var(--bsi-live); color: white; }
    .injury-status.questionable { background: var(--bsi-warning); color: #1A1A1A; }
    .injury-status.probable { background: var(--bsi-success); color: white; }
    .main-content { flex: 1; min-width: 0; padding: 1.5rem; }
    .page-header { margin-bottom: 1.5rem; }
    .page-header h1 {
      font-family: var(--font-display);
      font-size: clamp(1.75rem, 4vw, 2.5rem);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.02em;
      margin-bottom: 0.25rem;
    }
    .page-subtitle { font-size: 1rem; color: var(--text-secondary); }
    .refresh-row { display: flex; align-items: center; gap: 1rem; margin-top: 0.75rem; flex-wrap: wrap; }
    .refresh-indicator { display: flex; align-items: center; gap: 0.5rem; font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-muted); }
    .refresh-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--bsi-success); animation: pulse 2s infinite; }
    .refresh-dot.refreshing { background: var(--bsi-burnt-orange); animation: spin 1s linear infinite; }
    @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.5; transform: scale(0.9); } }
    @keyframes spin { to { transform: rotate(360deg); } }
    .sport-tabs { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; overflow-x: auto; padding-bottom: 0.5rem; -webkit-overflow-scrolling: touch; }
    .sport-tab {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-family: var(--font-ui);
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      padding: 0.625rem 1rem;
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      color: var(--text-secondary);
      transition: all var(--transition-fast);
      white-space: nowrap;
    }
    .sport-tab:hover { border-color: var(--bsi-burnt-orange); color: var(--text-primary); }
    .sport-tab.active { background: var(--bsi-burnt-orange); border-color: var(--bsi-burnt-orange); color: white; }
    .sport-tab svg { width: 16px; height: 16px; }
    .sport-tab .count { font-size: 0.65rem; padding: 0.1rem 0.4rem; background: rgba(255,255,255,0.2); border-radius: 10px; }
    .sport-tab.active .count { background: rgba(255,255,255,0.3); }
    .scores-section { margin-bottom: 2rem; }
    .section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; gap: 1rem; }
    .section-title { display: flex; align-items: center; gap: 0.75rem; }
    .section-title h2 { font-family: var(--font-display); font-size: 1.25rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.02em; }
    .section-source { font-family: var(--font-mono); font-size: 0.65rem; color: var(--text-muted); padding: 0.2rem 0.5rem; background: var(--bg-card); border-radius: var(--radius-sm); }
    .live-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.25rem 0.6rem;
      background: var(--bsi-live);
      border-radius: 4px;
      font-family: var(--font-ui);
      font-size: 0.65rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: white;
    }
    .live-badge::before { content: ''; width: 5px; height: 5px; background: white; border-radius: 50%; animation: pulse 1.5s infinite; }
    .scores-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 1rem; }
    .score-card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      overflow: hidden;
      transition: all var(--transition-normal);
    }
    .score-card:hover { border-color: var(--border-hover); transform: translateY(-2px); box-shadow: var(--shadow-md); }
    .score-card.live { border-color: var(--bsi-live); box-shadow: var(--shadow-glow); animation: live-pulse 3s ease-in-out infinite; }
    @keyframes live-pulse { 0%, 100% { box-shadow: 0 0 15px rgba(198, 40, 40, 0.2); } 50% { box-shadow: 0 0 25px rgba(198, 40, 40, 0.4); } }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 1rem;
      background: rgba(0,0,0,0.1);
      border-bottom: 1px solid var(--border-color);
    }
        .card-league { font-family: var(--font-ui); font-size: 0.7rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: var(--bsi-burnt-orange); }
    .card-status { font-family: var(--font-mono); font-size: 0.7rem; padding: 0.2rem 0.5rem; border-radius: 4px; background: rgba(255,255,255,0.1); color: var(--text-secondary); }
    .card-status.live { background: var(--bsi-live); color: white; animation: status-pulse 1.5s infinite; }
    @keyframes status-pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    .card-status.final { background: var(--bsi-success); color: white; }
    .card-body { padding: 1rem; }
    .team-row { display: flex; align-items: center; justify-content: space-between; padding: 0.5rem 0; }
    .team-row + .team-row { border-top: 1px solid var(--border-color); }
    .team-info { display: flex; align-items: center; gap: 0.75rem; min-width: 0; }
    .team-logo { width: 32px; height: 32px; object-fit: contain; border-radius: 4px; background: rgba(255,255,255,0.05); }
    .team-details { min-width: 0; }
    .team-name { font-family: var(--font-ui); font-weight: 600; font-size: 0.95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .team-record { font-family: var(--font-mono); font-size: 0.65rem; color: var(--text-muted); }
    .team-score { font-family: var(--font-mono); font-size: 1.5rem; font-weight: 700; min-width: 40px; text-align: right; }
    .team-score.winner { color: var(--bsi-gold); }
    .card-footer { display: flex; flex-wrap: wrap; gap: 0.5rem; padding: 0.75rem 1rem; background: rgba(0,0,0,0.05); border-top: 1px solid var(--border-color); }
        .odds-chip { display: flex; align-items: center; gap: 0.3rem; font-family: var(--font-mono); font-size: 0.65rem; padding: 0.25rem 0.5rem; background: var(--bg-secondary); border-radius: var(--radius-sm); color: var(--text-secondary); }
    .odds-chip.spread { border-left: 2px solid var(--bsi-info); }
    .odds-chip.moneyline { border-left: 2px solid var(--bsi-gold); }
    .odds-chip.total { border-left: 2px solid var(--bsi-success); }
    .no-games { text-align: center; padding: 4rem 2rem; color: var(--text-muted); }
    .no-games h3 { font-family: var(--font-display); font-size: 1.5rem; font-weight: 600; text-transform: uppercase; margin-bottom: 0.5rem; color: var(--text-secondary); }
    .no-games p { max-width: 400px; margin: 0 auto; }
    .loading-card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 3rem; text-align: center; }
    .loading-spinner { width: 32px; height: 32px; border: 3px solid var(--border-color); border-top-color: var(--bsi-burnt-orange); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem; }
    .footer { padding: 2rem 1.5rem; background: var(--bg-secondary); text-align: center; border-top: 1px solid var(--border-color); }
    .footer p { color: var(--text-muted); font-size: 0.875rem; }
    .footer .tagline { font-family: var(--font-body); font-style: italic; color: var(--bsi-burnt-orange); margin-top: 0.25rem; }
    @media (max-width: 1024px) { .sidebar { display: none; } }
    @media (max-width: 768px) {
      .nav { display: none; }
      .mobile-menu-btn { display: flex; }
      .page-wrapper { padding-top: 56px; }
      .main-content { padding: 1rem; }
      .scores-grid { grid-template-columns: 1fr; }
      .sport-tabs { gap: 0.375rem; }
      .sport-tab { padding: 0.5rem 0.75rem; font-size: 0.7rem; }
      .sport-tab svg { display: none; }
    }
    @media (max-width: 480px) {
      .logo { font-size: 1rem; }
      .page-header h1 { font-size: 1.5rem; }
      .team-logo { width: 28px; height: 28px; }
      .team-name { font-size: 0.85rem; }
      .team-score { font-size: 1.25rem; }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-inner">
      <a href="/" class="logo">Blaze Sports Intel</a>
      <nav class="nav">
        <a href="/college-baseball">College Baseball</a>
        <a href="/mlb">MLB</a>
        <a href="/nfl">NFL</a>
        <a href="/scores" class="active">Scores</a>
        <a href="/tools">Tools</a>
      </nav>
      <div class="header-controls">
        <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark/light mode">
          <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"/>
            <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
          </svg>
        </button>
        <a href="/login" class="nav-link" style="font-family: var(--font-ui); font-size: 0.8rem; text-transform: uppercase; color: var(--text-secondary);">Sign In</a>
        <button class="mobile-menu-btn" aria-label="Menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12h18M3 6h18M3 18h18"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <div class="page-wrapper">
    <aside class="sidebar" id="injuries-sidebar">
      <div class="sidebar-section">
        <h3>Key Injuries</h3>
        <div id="injuries-list">
          <div class="loading-card" style="padding: 1rem;">
            <div class="loading-spinner" style="width: 20px; height: 20px;"></div>
            <span style="font-size: 0.75rem;">Loading injuries...</span>
          </div>
        </div>
      </div>
      <div class="sidebar-section">
        <h3>Data Sources</h3>
        <div id="sources-list" style="font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-muted);">
          <p>MLB: Highlightly Pro</p>
          <p>NFL: Highlightly Pro</p>
          <p>NBA: ESPN</p>
          <p>College: Highlightly Pro</p>
        </div>
      </div>
    </aside>

    <main class="main-content">
      <div class="page-header">
        <h1>Live Scores</h1>
        <p class="page-subtitle">Real-time updates across MLB, NFL, NBA, and College sports</p>
        <div class="refresh-row">
          <div class="refresh-indicator">
            <span class="refresh-dot" id="refresh-dot"></span>
            <span>Auto-refresh: <span id="refresh-countdown">15</span>s</span>
          </div>
          <span id="last-updated" style="font-family: var(--font-mono); font-size: 0.7rem; color: var(--text-muted);"></span>
        </div>
      </div>

      <nav class="sport-tabs" role="tablist" aria-label="Filter by sport">
        <button class="sport-tab active" data-league="all" role="tab" aria-selected="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/><path d="M2 12h20"/></svg>
          All
          <span class="count" id="count-all">0</span>
        </button>
        <button class="sport-tab" data-league="mlb" role="tab" aria-selected="false">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 2c1.5 3 2 6 2 10s-.5 7-2 10"/><path d="M12 2c-1.5 3-2 6-2 10s.5 7 2 10"/></svg>
          MLB
          <span class="count" id="count-mlb">0</span>
        </button>
        <button class="sport-tab" data-league="nfl" role="tab" aria-selected="false">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="12" rx="10" ry="6"/><path d="M12 6v12"/></svg>
          NFL
          <span class="count" id="count-nfl">0</span>
        </button>
        <button class="sport-tab" data-league="nba" role="tab" aria-selected="false">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 2v20M2 12h20"/><path d="M4.93 4.93c4.08 4.08 10.06 4.08 14.14 0"/><path d="M4.93 19.07c4.08-4.08 10.06-4.08 14.14 0"/></svg>
          NBA
          <span class="count" id="count-nba">0</span>
        </button>
        <button class="sport-tab" data-league="ncaab" role="tab" aria-selected="false">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 2c1.5 3 2 6 2 10s-.5 7-2 10"/><path d="M12 2c-1.5 3-2 6-2 10s.5 7 2 10"/></svg>
          College Baseball
          <span class="count" id="count-ncaab">0</span>
        </button>
        <button class="sport-tab" data-league="ncaaf" role="tab" aria-selected="false">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="12" rx="10" ry="6"/><path d="M12 6v12"/></svg>
          College Football
          <span class="count" id="count-ncaaf">0</span>
        </button>
      </nav>

      <section class="scores-section" id="live-section">
        <div class="section-header">
          <div class="section-title">
            <h2>Live Now</h2>
            <span class="live-badge">Live</span>
          </div>
          <span class="section-source" id="live-source"></span>
        </div>
        <div class="scores-grid" id="live-grid">
          <div class="loading-card">
            <div class="loading-spinner"></div>
            <p>Checking for live games...</p>
          </div>
        </div>
      </section>

      <section class="scores-section" id="upcoming-section">
        <div class="section-header">
          <div class="section-title">
            <h2>Upcoming</h2>
          </div>
          <span class="section-source" id="upcoming-source"></span>
        </div>
        <div class="scores-grid" id="upcoming-grid">
          <div class="loading-card">
            <div class="loading-spinner"></div>
            <p>Loading upcoming games...</p>
          </div>
        </div>
      </section>

      <section class="scores-section" id="final-section">
        <div class="section-header">
          <div class="section-title">
            <h2>Final</h2>
          </div>
          <span class="section-source" id="final-source"></span>
        </div>
        <div class="scores-grid" id="final-grid">
          <div class="loading-card">
            <div class="loading-spinner"></div>
            <p>Loading completed games...</p>
          </div>
        </div>
      </section>

      <div class="no-games" id="no-games" style="display: none;">
        <h3>No Games Right Now</h3>
        <p>Check back during game time for live scores and updates. Games refresh automatically every 15 seconds.</p>
      </div>
    </main>
  </div>

  <footer class="footer">
    <p>&copy; 2025 Blaze Sports Intel. Boerne, Texas.</p>
    <p class="tagline">Born to Blaze the Path Less Beaten.</p>
  </footer>

  <script src="/src/js/attribution-footer.js"></script>
  <script>
    (function() {
      'use strict';
      var allGames = [];
      var allOdds = {};
      var allInjuries = [];
      var currentFilter = 'all';
      var refreshInterval = null;
      var countdownInterval = null;
      var countdown = 15;
      var sources = {};

      var themeToggle = document.getElementById('theme-toggle');
      var savedTheme = localStorage.getItem('bsi-theme') || 'dark';
      document.documentElement.setAttribute('data-theme', savedTheme);

      themeToggle.addEventListener('click', function() {
        var current = document.documentElement.getAttribute('data-theme');
        var next = current === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', next);
        localStorage.setItem('bsi-theme', next);
      });

      document.querySelectorAll('.sport-tab').forEach(function(tab) {
        tab.addEventListener('click', function() {
          document.querySelectorAll('.sport-tab').forEach(function(t) {
            t.classList.remove('active');
            t.setAttribute('aria-selected', 'false');
          });
          tab.classList.add('active');
          tab.setAttribute('aria-selected', 'true');
          currentFilter = tab.dataset.league;
          renderGames();
        });
      });

      function formatTime(dateStr) {
        if (!dateStr) return '';
        var d = new Date(dateStr);
        return d.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', timeZone: 'America/Chicago' });
      }

      function getTeamLogo(team) {
        if (team.logo) return team.logo;
        return 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><rect fill="#333" width="40" height="40" rx="4"/><text fill="#fff" font-family="sans-serif" font-size="14" font-weight="bold" x="20" y="25" text-anchor="middle">' + (team.abbreviation || team.name?.charAt(0) || '?') + '</text></svg>');
      }

      function createScoreCard(game) {
        var card = document.createElement('div');
        card.className = 'score-card' + (game.isLive ? ' live' : '');
        card.setAttribute('data-league', game.league);
        var odds = allOdds[game.id];
        var hasOdds = odds && (odds.spread || odds.moneyline || odds.overUnder);
        card.innerHTML = '<div class="card-header"><span class="card-league">' + game.league.toUpperCase() + '</span><span class="card-status ' + (game.isLive ? 'live' : game.isFinal ? 'final' : '') + '">' + (game.isLive ? (game.status || 'LIVE') : game.isFinal ? 'FINAL' : (formatTime(game.startTime) || game.status || 'SCHEDULED')) + '</span></div><div class="card-body"><div class="team-row"><div class="team-info"><img class="team-logo" src="' + getTeamLogo(game.away) + '" alt="' + (game.away.name || 'Away') + '" loading="lazy" onerror="this.style.display=\'none\'"><div class="team-details"><div class="team-name">' + (game.away.name || 'Away') + '</div>' + (game.away.record ? '<div class="team-record">' + game.away.record + '</div>' : '') + '</div></div><span class="team-score ' + (game.isFinal && game.away.score > game.home.score ? 'winner' : '') + '">' + ((game.isLive || game.isFinal) ? game.away.score : '-') + '</span></div><div class="team-row"><div class="team-info"><img class="team-logo" src="' + getTeamLogo(game.home) + '" alt="' + (game.home.name || 'Home') + '" loading="lazy" onerror="this.style.display=\'none\'"><div class="team-details"><div class="team-name">' + (game.home.name || 'Home') + '</div>' + (game.home.record ? '<div class="team-record">' + game.home.record + '</div>' : '') + '</div></div><span class="team-score ' + (game.isFinal && game.home.score > game.away.score ? 'winner' : '') + '">' + ((game.isLive || game.isFinal) ? game.home.score : '-') + '</span></div></div>' + (hasOdds || game.details ? '<div class="card-footer">' + (game.details ? '<span class="odds-chip">' + game.details + '</span>' : '') + (odds && odds.spread && odds.spread.home ? '<span class="odds-chip spread">Spread: ' + (odds.spread.home > 0 ? '+' : '') + odds.spread.home + '</span>' : '') + (odds && odds.moneyline && odds.moneyline.home ? '<span class="odds-chip moneyline">ML: ' + (odds.moneyline.home > 0 ? '+' : '') + odds.moneyline.home + '</span>' : '') + (odds && odds.overUnder ? '<span class="odds-chip total">O/U: ' + odds.overUnder + '</span>' : '') + '</div>' : '');
        return card;
      }

      function renderGames() {
        var liveGrid = document.getElementById('live-grid');
        var upcomingGrid = document.getElementById('upcoming-grid');
        var finalGrid = document.getElementById('final-grid');
        var noGames = document.getElementById('no-games');
        liveGrid.innerHTML = '';
        upcomingGrid.innerHTML = '';
        finalGrid.innerHTML = '';
        var filtered = allGames;
        if (currentFilter !== 'all') {
          filtered = allGames.filter(function(g) { return g.league === currentFilter; });
        }
        var live = filtered.filter(function(g) { return g.isLive; });
        var upcoming = filtered.filter(function(g) { return !g.isLive && !g.isFinal; });
        var final = filtered.filter(function(g) { return g.isFinal; });
        document.getElementById('count-all').textContent = allGames.length;
        document.getElementById('count-mlb').textContent = allGames.filter(function(g) { return g.league === 'mlb'; }).length;
        document.getElementById('count-nfl').textContent = allGames.filter(function(g) { return g.league === 'nfl'; }).length;
        document.getElementById('count-nba').textContent = allGames.filter(function(g) { return g.league === 'nba'; }).length;
        document.getElementById('count-ncaab').textContent = allGames.filter(function(g) { return g.league === 'ncaab'; }).length;
        document.getElementById('count-ncaaf').textContent = allGames.filter(function(g) { return g.league === 'ncaaf'; }).length;
        if (live.length > 0) {
          document.getElementById('live-section').style.display = 'block';
          live.forEach(function(game) { liveGrid.appendChild(createScoreCard(game)); });
        } else {
          document.getElementById('live-section').style.display = 'none';
        }
        if (upcoming.length > 0) {
          document.getElementById('upcoming-section').style.display = 'block';
          upcoming.forEach(function(game) { upcomingGrid.appendChild(createScoreCard(game)); });
        } else {
          document.getElementById('upcoming-section').style.display = 'none';
        }
        if (final.length > 0) {
          document.getElementById('final-section').style.display = 'block';
          final.forEach(function(game) { finalGrid.appendChild(createScoreCard(game)); });
        } else {
          document.getElementById('final-section').style.display = 'none';
        }
        noGames.style.display = filtered.length === 0 ? 'block' : 'none';
        if (sources && Object.keys(sources).length > 0) {
          var sourceText = Object.keys(sources).map(function(k) { return k.toUpperCase() + ': ' + sources[k]; }).join(' | ');
          document.getElementById('live-source').textContent = sourceText;
        }
      }

      function renderInjuries() {
        var list = document.getElementById('injuries-list');
        if (!allInjuries || allInjuries.length === 0) {
          list.innerHTML = '<p style="font-size: 0.75rem; color: var(--text-muted); padding: 0.5rem;">No injuries reported</p>';
          return;
        }
        list.innerHTML = allInjuries.slice(0, 10).map(function(injury) {
          var statusClass = (injury.status || '').toLowerCase().indexOf('out') > -1 ? 'out' : (injury.status || '').toLowerCase().indexOf('quest') > -1 ? 'questionable' : 'probable';
          return '<div class="injury-item"><img class="injury-avatar" src="' + (injury.player && injury.player.headshot ? injury.player.headshot : 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40"><rect fill="#333" width="40" height="40" rx="20"/><circle fill="#666" cx="20" cy="16" r="8"/><ellipse fill="#666" cx="20" cy="38" rx="12" ry="10"/></svg>')) + '" alt="' + (injury.player && injury.player.name ? injury.player.name : 'Player') + '" onerror="this.style.display=\'none\'"><div class="injury-info"><div class="injury-name">' + (injury.player && injury.player.name ? injury.player.name : 'Unknown') + '</div><div class="injury-team">' + (injury.player && injury.player.team ? injury.player.team : '') + ' - ' + (injury.injury || 'Undisclosed') + '</div></div><span class="injury-status ' + statusClass + '">' + (injury.status || 'Out') + '</span></div>';
        }).join('');
      }

      async function loadAllScores() {
        var dot = document.getElementById('refresh-dot');
        dot.classList.add('refreshing');
        try {
          var response = await fetch('/api/scores/all');
          var data = await response.json();
          allGames = [].concat(data.mlb || [], data.nfl || [], data.nba || [], data.ncaab || [], data.ncaaf || []);
          sources = data.sources || {};
          renderGames();
          // Add attribution footer to scores container
          BSIAttribution.update('.main-content', { fetchedAt: data.fetchedAt || new Date().toISOString(), compact: true });
          var now = new Date();
          document.getElementById('last-updated').textContent = 'Updated: ' + now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', second: '2-digit', timeZone: 'America/Chicago', timeZoneName: 'short' });
        } catch (e) {
          console.error('Error loading scores:', e);
          document.getElementById('live-grid').innerHTML = '<div class="loading-card"><p style="color: var(--bsi-live);">Unable to load scores. Retrying...</p></div>';
        }
        dot.classList.remove('refreshing');
      }

      async function loadInjuries() {
        try {
          var sport = currentFilter === 'all' ? 'mlb' : currentFilter === 'ncaab' ? 'mlb' : currentFilter === 'ncaaf' ? 'cfb' : currentFilter;
          var response = await fetch('/api/injuries/' + sport);
          var data = await response.json();
          allInjuries = data.injuries || [];
          renderInjuries();
        } catch (e) {
          console.error('Injuries fetch error:', e);
          allInjuries = [];
          renderInjuries();
        }
      }

      async function loadOdds() {
        try {
          var sport = currentFilter === 'all' ? 'mlb' : currentFilter === 'ncaab' ? 'mlb' : currentFilter === 'ncaaf' ? 'cfb' : currentFilter;
          var response = await fetch('/api/betting/' + sport);
          var data = await response.json();
          allOdds = {};
          (data.odds || []).forEach(function(o) { allOdds[o.gameId] = o; });
        } catch (e) {
          console.error('Odds fetch error:', e);
          allOdds = {};
        }
      }

      function startCountdown() {
        countdown = 15;
        document.getElementById('refresh-countdown').textContent = countdown;
        if (countdownInterval) clearInterval(countdownInterval);
        countdownInterval = setInterval(function() {
          countdown--;
          document.getElementById('refresh-countdown').textContent = countdown;
          if (countdown <= 0) countdown = 15;
        }, 1000);
      }

      async function init() {
        await Promise.all([loadAllScores(), loadInjuries(), loadOdds()]);
        startCountdown();
        refreshInterval = setInterval(function() { loadAllScores(); startCountdown(); }, 15000);
        setInterval(function() { loadInjuries(); loadOdds(); }, 60000);
      }

      init();

      window.addEventListener('beforeunload', function() {
        if (refreshInterval) clearInterval(refreshInterval);
        if (countdownInterval) clearInterval(countdownInterval);
      });
    })();
  </script>
  <script>if('serviceWorker' in navigator){navigator.serviceWorker.register('/sw.js').catch(console.error);}</script>
</body>
</html>
