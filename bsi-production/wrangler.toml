name = "bsi-home"
main = "worker.js"
compatibility_date = "2024-12-01"
compatibility_flags = ["nodejs_compat"]
account_id = "a12cb329d84130460eed99b816e4d0d3"

# Route configuration
routes = [
  { pattern = "blazesportsintel.com/*", zone_name = "blazesportsintel.com" },
  { pattern = "www.blazesportsintel.com/*", zone_name = "blazesportsintel.com" }
]

# Environment variables
[vars]
ENVIRONMENT = "production"
TIMEZONE = "America/Chicago"
R2_PREFIX = "origin/"

# R2 bucket for static assets
[[r2_buckets]]
binding = "BSI_ASSETS"
bucket_name = "blazesports-assets"

# D1 database for users, subscriptions, sessions
[[d1_databases]]
binding = "BSI_GAME_DB"
database_name = "bsi-game-db"
database_id = "88eb676f-af0f-470c-a46a-b9429f5b51f3"

# KV namespace for sessions
[[kv_namespaces]]
binding = "BSI_SESSIONS"
id = "b03e0651b4a34078a3e031bc5bc14ad7"

# KV namespace for analytics events (batch processing fallback)
[[kv_namespaces]]
binding = "BSI_ANALYTICS_KV"
id = "78cfab88ebc24bb1a96a3081be48e17c"

# Analytics Engine for time-series metrics
[[analytics_engine_datasets]]
binding = "ANALYTICS"
dataset = "bsi_home_analytics"

# Staging environment
[env.staging]
name = "bsi-home-staging"
routes = [
  { pattern = "staging.blazesportsintel.com/*", zone_name = "blazesportsintel.com" }
]

[env.staging.vars]
ENVIRONMENT = "staging"

# Observability
[observability]
enabled = true
head_sampling_rate = 1

# Development settings
[dev]
port = 8788
local_protocol = "http"

# Cron triggers for scheduled sync
[triggers]
crons = ["0 */6 * * *"]  # Every 6 hours (4x daily at 00:00, 06:00, 12:00, 18:00 UTC)

# Secrets (set via wrangler secret put):
# - SPORTSDATAIO_API_KEY
# - COLLEGEFOOTBALLDATA_API_KEY
# - SPORTSRADAR_MASTER_API_KEY
# - THEODDSAPI_KEY
# - STRIPE_SECRET_KEY
# - STRIPE_WEBHOOK_SECRET
# - SESSION_SECRET
# - RESEND_API_KEY
