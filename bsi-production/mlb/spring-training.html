<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Training 2025 | MLB | Blaze Sports Intel</title>
    <meta name="description" content="MLB Spring Training 2025 scores, schedules, and standings. Cactus League and Grapefruit League coverage.">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        :root {
            --burnt-orange: #BF5700;
            --texas-soil: #8B4513;
            --ember: #FF6B35;
            --charcoal: #1A1A1A;
            --midnight: #0D0D0D;
            --cream: #FAF8F5;
            --gold: #C9A227;
            --success: #2E7D32;
            --cardinals-red: #C41E3A;
            --cactus-green: #228B22;
            --grapefruit-orange: #FF8C00;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Cormorant Garamond', Georgia, serif;
            background: var(--midnight);
            color: var(--cream);
            min-height: 100vh;
            line-height: 1.6;
        }

        .nav {
            background: var(--charcoal);
            border-bottom: 2px solid var(--burnt-orange);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--burnt-orange);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-links a {
            color: var(--cream);
            text-decoration: none;
            font-family: 'Oswald', sans-serif;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: color 0.2s;
        }

        .nav-links a:hover { color: var(--ember); }
        .nav-links a.active { color: var(--burnt-orange); }

        .hero {
            background: linear-gradient(135deg, var(--charcoal) 0%, var(--midnight) 100%);
            padding: 3rem 2rem;
            text-align: center;
            border-bottom: 3px solid var(--burnt-orange);
        }

        .hero-title {
            font-family: 'Oswald', sans-serif;
            font-size: 3rem;
            font-weight: 700;
            color: var(--cream);
            margin-bottom: 0.5rem;
        }

        .hero-subtitle {
            font-size: 1.25rem;
            color: rgba(250, 248, 245, 0.7);
        }

        .season-badge {
            display: inline-block;
            background: var(--burnt-orange);
            color: var(--cream);
            font-family: 'Oswald', sans-serif;
            font-size: 0.85rem;
            text-transform: uppercase;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin-top: 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .league-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .league-tab {
            font-family: 'Oswald', sans-serif;
            font-size: 1rem;
            text-transform: uppercase;
            padding: 1rem 2rem;
            background: var(--charcoal);
            border: 2px solid transparent;
            border-radius: 4px;
            color: var(--cream);
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }

        .league-tab:hover { border-color: var(--burnt-orange); }

        .league-tab.active.cactus {
            background: var(--cactus-green);
            border-color: var(--cactus-green);
        }

        .league-tab.active.grapefruit {
            background: var(--grapefruit-orange);
            border-color: var(--grapefruit-orange);
        }

        .league-tab.active.all {
            background: var(--burnt-orange);
            border-color: var(--burnt-orange);
        }

        .league-info {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-top: 0.25rem;
        }

        .featured-team {
            background: linear-gradient(135deg, var(--cardinals-red) 0%, #9c1730 100%);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .featured-team-logo {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .featured-team-info h3 {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .featured-team-info p {
            opacity: 0.9;
        }

        .games-section {
            margin-bottom: 2rem;
        }

        .section-header {
            font-family: 'Oswald', sans-serif;
            font-size: 1.25rem;
            text-transform: uppercase;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--burnt-orange);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1rem;
        }

        .game-card {
            background: var(--charcoal);
            border-radius: 8px;
            padding: 1.25rem;
            border-left: 4px solid var(--burnt-orange);
            transition: transform 0.2s;
        }

        .game-card:hover {
            transform: translateY(-2px);
        }

        .game-card.cardinals {
            border-left-color: var(--cardinals-red);
            background: linear-gradient(90deg, rgba(196, 30, 58, 0.1) 0%, var(--charcoal) 100%);
        }

        .game-card.live {
            border-left-color: var(--success);
        }

        .game-status {
            font-family: 'Oswald', sans-serif;
            font-size: 0.75rem;
            text-transform: uppercase;
            color: var(--gold);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .game-status.live {
            color: var(--success);
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: var(--success);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .game-matchup {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .game-team {
            flex: 1;
        }

        .game-team-name {
            font-family: 'Oswald', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--cream);
        }

        .game-team-record {
            font-size: 0.8rem;
            color: rgba(250, 248, 245, 0.5);
        }

        .game-score {
            font-family: 'Oswald', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--cream);
            text-align: center;
            min-width: 60px;
        }

        .game-venue {
            font-size: 0.85rem;
            color: rgba(250, 248, 245, 0.6);
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid rgba(250, 248, 245, 0.1);
        }

        .loading {
            text-align: center;
            padding: 4rem 2rem;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--charcoal);
            border-top-color: var(--burnt-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .no-games {
            text-align: center;
            padding: 3rem 2rem;
            background: var(--charcoal);
            border-radius: 8px;
            color: rgba(250, 248, 245, 0.7);
        }

        .no-games h3 {
            font-family: 'Oswald', sans-serif;
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--cream);
        }

        .source-citation {
            text-align: center;
            padding: 1.5rem;
            color: rgba(250, 248, 245, 0.5);
            font-size: 0.85rem;
            border-top: 1px solid rgba(250, 248, 245, 0.1);
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .nav { padding: 1rem; flex-wrap: wrap; gap: 1rem; }
            .nav-links { gap: 1rem; }
            .hero { padding: 2rem 1rem; }
            .hero-title { font-size: 2rem; }
            .container { padding: 1rem; }
            .featured-team { flex-direction: column; text-align: center; padding: 1.25rem; }
            .featured-team-logo { width: 60px; height: 60px; }
            .games-grid { grid-template-columns: 1fr; }
            .league-tabs { gap: 0.5rem; }
            .league-tab { padding: 0.75rem 1rem; font-size: 0.9rem; min-width: auto; }
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="/" class="nav-logo">BLAZE SPORTS INTEL</a>
        <div class="nav-links">
            <a href="/mlb/">MLB</a>
            <a href="/mlb/scores">Scores</a>
            <a href="/mlb/standings">Standings</a>
            <a href="/mlb/spring-training" class="active">Spring Training</a>
        </div>
    </nav>

    <header class="hero">
        <h1 class="hero-title">Spring Training 2025</h1>
        <p class="hero-subtitle">Cactus League & Grapefruit League</p>
        <span class="season-badge" id="seasonBadge">Loading...</span>
    </header>

    <main class="container">
        <!-- Cardinals Featured Section -->
        <div class="featured-team" id="cardinalsFeature">
            <div class="featured-team-logo">STL</div>
            <div class="featured-team-info">
                <h3>St. Louis Cardinals</h3>
                <p>Grapefruit League • Roger Dean Chevrolet Stadium, Jupiter, FL</p>
            </div>
        </div>

        <!-- League Filter Tabs -->
        <div class="league-tabs">
            <button class="league-tab active all" data-league="all">
                All Games
                <div class="league-info">Both Leagues</div>
            </button>
            <button class="league-tab cactus" data-league="cactus">
                Cactus League
                <div class="league-info">Arizona</div>
            </button>
            <button class="league-tab grapefruit" data-league="grapefruit">
                Grapefruit League
                <div class="league-info">Florida</div>
            </button>
        </div>

        <div id="gamesContent">
            <div class="loading">
                <div class="loading-spinner"></div>
                <p>Loading Spring Training games...</p>
            </div>
        </div>

        <div class="source-citation">
            Data provided by ESPN & MLB • Updated <span id="updateTime">-</span>
        </div>
    </main>

    <script>
        // Team league mappings
        const CACTUS_LEAGUE = ['ARI', 'CHC', 'CWS', 'CIN', 'CLE', 'COL', 'KC', 'LAA', 'LAD', 'MIL', 'OAK', 'SD', 'SF', 'SEA', 'TEX'];
        const GRAPEFRUIT_LEAGUE = ['ATL', 'BAL', 'BOS', 'DET', 'HOU', 'MIA', 'MIN', 'NYM', 'NYY', 'PHI', 'PIT', 'STL', 'TB', 'TOR', 'WSH'];

        let currentFilter = 'all';
        let allGames = [];

        // Safe DOM helpers
        function createElement(tag, className, textContent) {
            const el = document.createElement(tag);
            if (className) el.className = className;
            if (textContent !== undefined) el.textContent = textContent;
            return el;
        }

        loadGames();

        async function loadGames() {
            try {
                const response = await fetch('/api/mlb/scores');
                if (!response.ok) throw new Error('Failed to load scores');

                const data = await response.json();
                allGames = data.games || [];

                // Update season badge
                const badge = document.getElementById('seasonBadge');
                if (data.seasonPhase) {
                    badge.textContent = data.seasonPhase.label || 'Spring Training 2025';
                } else {
                    badge.textContent = 'Spring Training 2025';
                }

                // Update timestamp
                document.getElementById('updateTime').textContent = data.fetchedAt || new Date().toLocaleString('en-US', { timeZone: 'America/Chicago' });

                renderGames();
                setupTabs();
            } catch (error) {
                console.error('Error loading games:', error);
                showError('Unable to load Spring Training games. Please try again.');
            }
        }

        function showError(message) {
            const content = document.getElementById('gamesContent');
            content.textContent = '';
            const noGames = createElement('div', 'no-games');
            const h3 = createElement('h3', null, 'Error');
            noGames.appendChild(h3);
            const p = createElement('p', null, message);
            noGames.appendChild(p);
            content.appendChild(noGames);
        }

        function getTeamLeague(abbr) {
            if (CACTUS_LEAGUE.includes(abbr)) return 'cactus';
            if (GRAPEFRUIT_LEAGUE.includes(abbr)) return 'grapefruit';
            return 'unknown';
        }

        function isCardinalsGame(game) {
            const homeAbbr = game.teams?.home?.abbreviation || '';
            const awayAbbr = game.teams?.away?.abbreviation || '';
            return homeAbbr === 'STL' || awayAbbr === 'STL';
        }

        function filterGames(games, filter) {
            if (filter === 'all') return games;

            return games.filter(game => {
                const homeAbbr = game.teams?.home?.abbreviation || '';
                const awayAbbr = game.teams?.away?.abbreviation || '';
                const homeLeague = getTeamLeague(homeAbbr);
                const awayLeague = getTeamLeague(awayAbbr);
                return homeLeague === filter || awayLeague === filter;
            });
        }

        function renderGames() {
            const content = document.getElementById('gamesContent');
            content.textContent = '';

            const filteredGames = filterGames(allGames, currentFilter);

            if (filteredGames.length === 0) {
                const noGames = createElement('div', 'no-games');
                const h3 = createElement('h3', null, 'No Games Scheduled');
                noGames.appendChild(h3);
                const p = createElement('p', null, 'Check back later for Spring Training action.');
                noGames.appendChild(p);
                content.appendChild(noGames);
                return;
            }

            // Separate Cardinals games and others
            const cardinalsGames = filteredGames.filter(isCardinalsGame);
            const otherGames = filteredGames.filter(g => !isCardinalsGame(g));

            // Cardinals games first if any
            if (cardinalsGames.length > 0) {
                const cardsSection = createElement('div', 'games-section');
                const cardsHeader = createElement('div', 'section-header', 'Cardinals Games');
                cardsSection.appendChild(cardsHeader);

                const cardsGrid = createElement('div', 'games-grid');
                cardinalsGames.forEach(game => {
                    cardsGrid.appendChild(createGameCard(game, true));
                });
                cardsSection.appendChild(cardsGrid);
                content.appendChild(cardsSection);
            }

            // Other games
            if (otherGames.length > 0) {
                const otherSection = createElement('div', 'games-section');
                const otherHeader = createElement('div', 'section-header', cardinalsGames.length > 0 ? 'Other Games' : 'All Games');
                otherSection.appendChild(otherHeader);

                const otherGrid = createElement('div', 'games-grid');
                otherGames.forEach(game => {
                    otherGrid.appendChild(createGameCard(game, false));
                });
                otherSection.appendChild(otherGrid);
                content.appendChild(otherSection);
            }
        }

        function createGameCard(game, isCardinals) {
            const card = createElement('div', 'game-card');
            if (isCardinals) card.classList.add('cardinals');

            const isLive = game.status?.isLive;
            if (isLive) card.classList.add('live');

            // Status
            const status = createElement('div', 'game-status' + (isLive ? ' live' : ''));
            if (isLive) {
                const dot = createElement('span', 'live-dot');
                status.appendChild(dot);
            }
            const statusText = document.createTextNode(game.status?.detailedState || game.status?.state || 'Scheduled');
            status.appendChild(statusText);
            card.appendChild(status);

            // Matchup
            const matchup = createElement('div', 'game-matchup');

            // Away team
            const awayDiv = createElement('div', 'game-team');
            const awayName = createElement('div', 'game-team-name', game.teams?.away?.abbreviation || game.teams?.away?.name || 'Away');
            awayDiv.appendChild(awayName);
            matchup.appendChild(awayDiv);

            // Score
            const scoreDiv = createElement('div', 'game-score');
            const awayScore = game.teams?.away?.score ?? '-';
            const homeScore = game.teams?.home?.score ?? '-';
            scoreDiv.textContent = awayScore + ' - ' + homeScore;
            matchup.appendChild(scoreDiv);

            // Home team
            const homeDiv = createElement('div', 'game-team');
            homeDiv.style.textAlign = 'right';
            const homeName = createElement('div', 'game-team-name', game.teams?.home?.abbreviation || game.teams?.home?.name || 'Home');
            homeDiv.appendChild(homeName);
            matchup.appendChild(homeDiv);

            card.appendChild(matchup);

            // Game time/venue
            const venueDiv = createElement('div', 'game-venue');
            if (game.dateTime) {
                try {
                    const gameDate = new Date(game.dateTime);
                    venueDiv.textContent = gameDate.toLocaleString('en-US', {
                        weekday: 'short',
                        month: 'short',
                        day: 'numeric',
                        hour: 'numeric',
                        minute: '2-digit',
                        timeZone: 'America/Chicago'
                    }) + ' CT';
                } catch {
                    venueDiv.textContent = game.dateTime;
                }
            }
            card.appendChild(venueDiv);

            return card;
        }

        function setupTabs() {
            document.querySelectorAll('.league-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.league-tab').forEach(t => {
                        t.classList.remove('active');
                    });

                    this.classList.add('active');
                    currentFilter = this.dataset.league;
                    renderGames();
                });
            });
        }
    </script>
<script>if("serviceWorker" in navigator){navigator.serviceWorker.register("/sw.js").catch(console.error);}</script>
</body>
</html>
